{% extends '::BOLayout.html.twig' %}

     {% block pagewrapper %}

         <div id="page-wrapper">

             <form id="formParams" action="">

                 <div class="row">
                     <div class="bs-example">
                         <ul class="breadcrumb">
                             <li><a href="{{ path('ffbb_accueil_connect') }}">Accueil</a></li>
                             <li><a href="{{ path('ffbb_poules_choisir_liste') }}">Choix de la liste d'équipes</a></li>
                             {#<li><a href="{{ path('ffbb_poule_choisir_groupe', {'idListe': idListe}) }}">Choix de groupes</a></li>#}
                             <li class="active">Participants</li>
                         </ul>
                     </div>

                     <div class="col-lg-12">
                         <h3 class="page-header">Sélectionnez vos critères et contraintes </h3>
                         {#<h4>{{ nomListe }} | {{ nomGroupe }}</h4>#}
                     </div>
                     <div class="col-lg-12">
                         <h5 style="float: right"> <strong> (* champs obligatoires)</strong>  </h5>
                     </div>

                     <!-- /.col-lg-12 -->
                 </div>
                 <!-- /.row -->
                 <div class="row">
                     {#(* Saisie obligatoire)#}

                     <!-- Type de rencontre bloc -->
                     <div class="col-lg-3">


                         <div class="panel panel-default">
                             <div class="panel-heading">
                                 Type de rencontre*
                             </div>
                             <!-- /.panel-heading -->
                             <div class="panel-body">
                                 {% if typeMatch == 'allerRetour' %}

                                     <div class="form-group">
                                         <div class="radio">
                                             <label>
                                                 <input type="radio" name="typeRencontre" id="typeRencontre1"
                                                        value="allerRetour" checked onclick="typeAllerRetour();">Match aller
                                                 retour
                                             </label>
                                         </div>
                                         <div class="radio">
                                             <label>
                                                 <input type="radio" name="typeRencontre" id="typeRencontre2"
                                                        value="allerSimple" onclick="typeAller();">Match aller simple
                                             </label>
                                         </div>
                                         <div class="radio">
                                             <label>
                                                 <input type="radio" name="typeRencontre" id="typeRencontre3"
                                                        value="plateau" onclick="typePlateau();">Plateau
                                             </label>
                                         </div>
                                     </div>

                                 {% elseif typeMatch == 'allerSimple' %}

                                     <div class="form-group">
                                         <div class="radio">
                                             <label>
                                                 <input type="radio" name="typeRencontre" id="typeRencontre1"
                                                        value="allerRetour" onclick="typeAllerRetour();">Match aller
                                                 retour
                                             </label>
                                         </div>
                                         <div class="radio">
                                             <label>
                                                 <input type="radio" name="typeRencontre" id="typeRencontre2"
                                                        value="allerSimple" checked onclick="typeAller();">Match aller simple
                                             </label>
                                         </div>
                                         <div class="radio">
                                             <label>
                                                 <input type="radio" name="typeRencontre" id="typeRencontre3"
                                                        value="plateau" onclick="typePlateau();">Plateau
                                             </label>
                                         </div>
                                     </div>

                                 {% else %}

                                     <div class="form-group">
                                         <div class="radio">
                                             <label>
                                                 <input type="radio" name="typeRencontre" id="typeRencontre1"
                                                        value="allerRetour" onclick="typeAllerRetour();">Match aller
                                                 retour
                                             </label>
                                         </div>
                                         <div class="radio">
                                             <label>
                                                 <input type="radio" name="typeRencontre" id="typeRencontre2"
                                                        value="allerSimple"  onclick="typeAller();">Match aller simple
                                             </label>
                                         </div>
                                         <div class="radio">
                                             <label>
                                                 <input type="radio" name="typeRencontre" id="typeRencontre3"
                                                        value="plateau" checked onclick="typePlateau();">Plateau
                                             </label>
                                         </div>
                                     </div>

                                 {% endif %}


                             </div>
                             <!-- /.panel-body -->
                         </div>
                     </div>
                     <!-- /. Type de rencontre bloc -->
                     <!-- Nombre de poules bloc -->
                     <div class="col-lg-3">
                         <div class="panel panel-default">
                             <div class="panel-heading">
                                 Nombre de poules*
                             </div>
                             <!-- /.panel-heading -->
                             <div class="panel-body">

                                 <div class="form-group">
                                     <input id="inputPoulesNbr" type="number" min="1" class="form-control" value="{{ nombrePoule  }}" required>
                                 </div>
                                 <h5> {{ nombrePoule }} poules de {{ taillePoule }} équipes </h5>

                             </div>
                             <!-- /.panel-body -->
                         </div>
                     </div>
                     <!-- /. Ajouter une contrainte bloc -->

                     <!-- Nombre de poules bloc -->
                     <div class="col-lg-3">
                         <div class="panel panel-default">
                             <div class="panel-heading">
                                 Contraintes ajoutées
                             </div>
                             <!-- /.panel-heading -->
                             <div class="panel-body">

                                 <div class="col-lg-12">
                                     <div class="col-lg-6">
                                         <h5>Interdictions</h5>
                                     </div>
                                     <div class="col-lg-6">
                                         <button type="button" class="btn btn-primary pull-right" onclick="ajouterInterdiction();">Voir</button>
                                     </div>

                                 </div>
                                 <div class="col-lg-12">
                                     <div class="col-lg-6">
                                         <h5>Répartitions homogènes</h5>
                                     </div>
                                     <div class="col-lg-6">
                                         <button type="button" class="btn btn-primary pull-right" onclick="ajouterRepartition();">Voir</button>
                                     </div>

                                 </div>


                             </div>
                             <!-- /.panel-body -->
                         </div>
                     </div>
                     <!-- /. Ajouter une contrainte bloc -->

                     <!-- Nombre de poules bloc -->
                     <div class="col-lg-3">
                         <div class="panel panel-default">
                             <div class="panel-heading">
                                 Ajouter une variation du nombre d'équipes par poule
                             </div>
                             <!-- /.panel-heading -->
                             <div class="panel-body">
                                 <h5>Choisissez le nombre d'équipes par poule à faire varier</h5>

                                 <div class="form-group">
                                     <input id="variationNbrEquipe" type="number" min="1" class="form-control" required>
                                 </div>

                             </div>
                             <!-- /.panel-body -->
                         </div>
                     </div>
                     <!-- /. Ajouter une contrainte bloc -->

                 </div>
                 <!-- /.row -->


                 <!-- Contraintes pour le choix plateau -->
                 <div class="row">

                     <!-- Nombre de journées bloc -->
                     <div class="col-lg-4" id="nbrJournee" style="display: none">
                         <div class="panel panel-default">
                             <div class="panel-heading">
                                 Nombre de journées*
                             </div>
                             <!-- /.panel-heading -->
                             <div class="panel-body">
                                 <div class="form-group">
                                     <input type="number" min="1" class="form-control">

                                 </div>

                             </div>
                             <!-- /.panel-body -->
                         </div>
                     </div>
                     <!-- /. Nombre de journées bloc -->

                     <!-- Nombre de rencontres par journée bloc -->
                     <div class="col-lg-4" id="nbrRencontre" style="display: none">
                         <div class="panel panel-default">
                             <div class="panel-heading">
                                 Nombre de rencontres par journée
                             </div>
                             <!-- /.panel-heading -->
                             <div class="panel-body">
                                 <div class="form-group">
                                     <input type="number" min="0" class="form-control">
                                 </div>

                             </div>
                             <!-- /.panel-body -->
                         </div>
                     </div>

                     <!-- /. Nombre de rencontres par journée bloc -->

                     <!-- Ajouter une contrainte bloc -->
                     <div class="col-lg-4" id="ajoutContrainte" style="display: none">
                         <div class="panel panel-default">
                             <div class="panel-heading">
                                 Ajouter une contrainte
                             </div>
                             <!-- /.panel-heading -->
                             <div class="panel-body">
                                 <div class="form-group">
                                     <label class="checkbox-inline">
                                         <input type="checkbox">Toutes les équipes doivent accueillir au moins une fois
                                     </label>

                                 </div>

                             </div>
                             <!-- /.panel-body -->
                         </div>
                     </div>
                     <!-- /. Ajouter une contrainte bloc -->
                 </div>

                 <!-- Ajouter des contraintes d'interdiction -->

                 <div class="row" style="display: none" id="interdiction">
                     <div class="panel panel-default">
                         <div class="panel-heading">
                             <span id="contrainteInterdiction" style="cursor:pointer"> Ajouter des contraintes d'interdiction </span>
                         </div>
                         <!-- /.panel-heading -->
                         <div class="panel-body" id="contrainteInterdictionBody" style="display: none">

                             <fieldset id="additional-field-model">
                                 <div class="form-group">

                                     <div class="col-md-6 col-sm-12">
                                         <div class="input-group">
                                             <input type="text" value="Interdiction 1">

                                             <select class="removeDuplication">

                                                 {#{%  for detailsVille in detailsVilles %}#}
                                                     {#<option value={{ detailsVille.id}}>{{ detailsVille.ville }}</option>#}
                                                 {#{% endfor %}#}


                                             </select>
                                             <select>
                                                 {#{%  for detailsVille in detailsVilles %}#}
                                                     {#<option value={{ detailsVille.id}}>{{ detailsVille.ville }}</option>#}
                                                 {#{% endfor %}#}
                                             </select>

                                         </div>

                                     </div>

                                     <div class="col-md-4 col-xs-7 text-right">
                                         <label class="col-xs-12 control-label" for="field-c"><br></label>
                                         <a href="javascript:void(0);" class="btn btn-warning remove-this-field" style="display: none;">
                                             <i class="fa fa-remove"></i>
                                             <span class="hidden-xs"> Supprimer </span>
                                         </a>
                                         <a href="javascript:void(0);" class="btn btn-success create-new-field" style="display: inline-block;">
                                             <i class="fa fa-plus"></i>
                                             <span class="hidden-xs"> Dupliquer </span>
                                         </a>
                                     </div>
                                 </div>
                             </fieldset>




                         </div>
                         <!-- /.panel-body -->
                     </div>

                 </div>

                 <!-- ajouter répartitions homogènes -->

                 <div class="row" id="repartitionHomogene" style="display: none">
                     <div class="panel panel-default">
                         <div class="panel-heading">
                             <span id="contrainteRepartition" style="cursor:pointer"> Ajouter des contraintes de répartition homogène</span>
                         </div>
                         <!-- /.panel-heading -->
                         <div class="panel-body" id="contrainteRepartitionBody" style="display: none">
                             <div class="panel-body">
                                 <div class="table-responsive">
                                     <table class="table table-striped table-bordered table-hover">
                                         <thead>
                                         <tr>
                                             <th><strong>Equipe</strong></th>
                                             <th><strong>Catégorie</strong></th>
                                         </tr>
                                         </thead>
                                         <tbody>

                                         {#{% for detailsVille in detailsVilles %}#}
                                             {#<tr>#}
                                                 {#<td>{{ detailsVille.ville }}</td>#}
                                                 {#<td>#}
                                                     {#<select class="form-control">#}
                                                         {#<option value="Aucun">Aucun</option>#}
                                                         {#<option value="Espoir">Espoir</option>#}
                                                         {#<option value="Descendant">Descendant</option>#}
                                                         {#<option value="Promu">Promu</option>#}
                                                         {#<option value="EquipeNiveauA">Equipe de niveau A</option>#}
                                                         {#<option value="EquipeNiveauB">Equipe de niveau B</option>#}
                                                         {#<option value="EquipeNiveauC">Equipe de niveau C</option>#}
                                                         {#<option value="TeteSerie1">Tête de série 1</option>#}
                                                         {#<option value="TeteSerie2">Tête de série 2</option>#}
                                                     {#</select>#}
                                                 {#</td>#}
                                             {#</tr>#}


                                         {#{% endfor %}#}

                                         </tbody>
                                     </table>
                                 </div>
                                 <!-- /.table-responsive -->
                             </div>
                             <!-- /.panel-body -->

                         </div>
                         <!-- /.panel-body -->
                     </div>

                 </div>


                <!-- bouton lancemenet de calcul -->
                 <div class="row">
                     <div class="col-lg-12">
                         <label id="lancerCalculBtn" class="btn btn-primary pull-right"> Relancer le calcul</label>
                     </div>
                 </div>

             </form>

             <hr>


             <!-- Affichage des résultats sur les cartes -->
             <div class="row">
                 <div class="col-lg-12">
                     <div class="panel panel-default">
                         <div class="panel-heading col-lg-12">
                             <div style="float:left; position:relative; width: 90%">
                                 <p>Les scénarios ci-dessous présentent les résultats les plus écoresponsables correspondant à votre recherche "Orga_Poule_FFBB_National_13082015_Recherche 1" </p>

                             </div>
                             <div style="float:left; position:relative; width: 10%">
                                 <button type="button" class="btn btn-primary"> Comparer les scénarios</button>

                             </div>

                         </div>

                         {% if contraintsExiste == 1 %}

                             <!-- .panel-heading -->
                             <div class="panel-body">

                                 <div class="row">

                                     <!--  Scénario optimal avec contrainte -->
                                     <div class="col-lg-6">
                                         <!-- declaration de variables -->
                                         <!-- distanceMin -->
                                         {% set distanceMin = scenarioOptimalAvecContrainte.estimationGenerale.distanceTotale %}
                                         {% set distanceMin = (distanceMin / 1000)|round %}
                                         <!-- distanceTotale -->
                                         {% set distanceTotale = scenarioOptimalAvecContrainte.estimationGenerale.distanceTotaleTousParticipants %}
                                         {% set distanceTotale = (distanceTotale / 1000)|round %}
                                         <!-- nbrParticipantsTotal -->
                                         {% set nbrParticipantsTotal = scenarioOptimalAvecContrainte.estimationGenerale.nbrParticipantsTotal %}
                                         <!-- estimationDetails -->
                                         {% set estimationDetailsOptContrainte = scenarioOptimalAvecContrainte.estimationDetails %}
                                         <!-- rencontreDetails -->
                                         {% set rencontreDetailsOptContrainte = scenarioOptimalAvecContrainte.rencontreDetails %}
                                         <!-- coordPoules -->
                                         {% set coordPoules = scenarioOptimalAvecContrainte.poulesCoords %}


                                         <div class="panel-body">
                                             <div class="panel-group" id="accordion">
                                                 <div class="panel panel-default">
                                                     <div class="panel-heading">
                                                         <h4 class="panel-title">
                                                             Scénario optimal
                                                         </h4>
                                                     </div>
                                                     <div id="collapseOne" class="panel-collapse collapse in">
                                                         <div class="panel-body"> <!-- premier scÃ©nario -->
                                                             <div id="map"
                                                                  style="width: 100%; height: 500px; background: grey"></div>
                                                             <script type="text/javascript" charset="UTF-8">

                                                                 /**
                                                                  *
                                                                  * Changer la langue de la carte
                                                                  */
                                                                 function switchMapLanguage(map, platform) {
                                                                     var mapTileService = platform.getMapTileService({
                                                                                 type: 'base'
                                                                             }),
                                                                             frenchMapLayer = mapTileService.createTileLayer(
                                                                                     'maptile',
                                                                                     'normal.day',
                                                                                     256,
                                                                                     'png8',
                                                                                     {lg: 'fre'}
                                                                             );
                                                                     map.setBaseLayer(frenchMapLayer);


                                                                 }
                                                                 /*
                                                                  Fin fn changer langue
                                                                  */

                                                                 // Create a marker icon from an image URL:

                                                                 var icons0 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon0.png') }}');
                                                                 var icons1 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon1.png') }}');
                                                                 var icons2 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon2.png') }}');
                                                                 var icons3 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon3.png') }}');
                                                                 var icons4 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon4.png') }}');
                                                                 var icons5 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon5.png') }}');
                                                                 var icons6 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon6.png') }}');
                                                                 var icons7 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon7.png') }}');
                                                                 var icons8 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon8.png') }}');
                                                                 var icons9 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon9.png') }}');

                                                                 //construction des points de differentes villes
                                                                 function addMarkersAndSetViewBounds() {
                                                                     var incrment = 1;
                                                                     var points = [];
                                                                     var incrementIcons = 0;

                                                                     {%  for coordPoule in coordPoules %}

                                                                        //tracer dynamiquement les points de villes
                                                                         {% for coordonneeVille in coordPoule %}
                                                                         var x = '{{ coordonneeVille[0]}}';
                                                                         var y = '{{ coordonneeVille[1]}}';
//
                                                                         var xy = x+y;
//                                                                         var x = xy[0];
//                                                                         var y = xy[1];

                                                                     var icon = 'icons' + incrementIcons;
                                                                         var marker = 'marker' + incrment;
                                                                         window[marker] = new H.map.Marker({
                                                                             lat: parseFloat(x),
                                                                             lng: parseFloat(y)
                                                                         }, {icon: window[icon]}  );


                                                                          points.push(window[marker]);

                                                                         var incrment = incrment + 1;

                                                                         {% endfor %}
                                                                     incrementIcons++;
                                                                     {% endfor %}
                                                                         group = new H.map.Group();
                                                                         // add markers to the group
                                                                         group.addObjects(points);
                                                                         map.addObject(group);
                                                                         // get geo bounding box for the group and set it to the map
                                                                         map.setViewBounds(group.getBounds());
                                                                 }



                                                                 /**
                                                                  * Boilerplate map initialization code starts below:
                                                                  */

                                                                 //Step 1: initialize communication with the platform
                                                                 var platform = new H.service.Platform({
                                                                     app_id: '{{ app_id }}',
                                                                     app_code: '{{ app_code }}',
                                                                     useCIT: true,
                                                                     useHTTPS: true
                                                                 });
                                                                 var defaultLayers = platform.createDefaultLayers();

                                                                 //Step 2: initialize a map - this map is centered over Europe
                                                                 var map = new H.Map(document.getElementById('map'),
                                                                         defaultLayers.normal.map, {
                                                                             center: {lat: 48.8567, lng: 2.3508},
                                                                             zoom: 3
                                                                         });

                                                                 var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
                                                                 // Create the default UI components
                                                                 //    var ui = H.ui.UI.createDefault(map, defaultLayers);
                                                                 var ui = H.ui.UI.createDefault(map, defaultLayers, 'fr-FR');

                                                                 // Now use the map as required...
                                                                 // Add the marker to the map:
                                                                 // map.addObject(markerPrincipal);
                                                                 addMarkersAndSetViewBounds(map);
                                                                 switchMapLanguage(map, platform);

                                                             </script>
                                                             <!-- Nav tabs -->
                                                             <ul class="nav nav-tabs">
                                                                 <li class="active"><a href="#Estimations" data-toggle="tab">Estimations</a>
                                                                 </li>
                                                                 <li><a href="#Details" data-toggle="tab">Détails</a>
                                                                 </li>
                                                                 <li><a href="#listeRencontresScOpt" data-toggle="tab">Liste des rencontres</a></li>
                                                             </ul>

                                                             <!-- Tab panes -->
                                                             <div class="tab-content">
                                                                 <div class="tab-pane fade in active" id="Estimations">

                                                                     <div class="list-group">

                                                                         <p class="list-group-item">
                                                                             <i class="fa fa-road fa-fw"
                                                                                style="padding-right: 30px"></i> <strong> {{ distanceMin }} </strong>
                                                                             kilomètres au total
                                                                             à parcourir pour l'ensemble du scénario
                                                                         </p>
                                                                         <p href="#" class="list-group-item">
                                                                             <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                                  width="20px" height="20px"/>
                                                                             <i style="padding-right: 10px"></i> <strong>{{ (distanceTotale * 0.80 )|round }}</strong>
                                                                             € pour réaliser les trajets de l'ensemble du scénario
                                                                             en voiture

                                                                         </p>
                                                                         <p href="#" class="list-group-item">
                                                                             <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                                  width="20px" height="20px"/>
                                                                             <i style="padding-right: 10px"></i> <strong>{{ (distanceTotale /4 * 0.80 )|round }} </strong>
                                                                             € pour réaliser les trajets de l'ensemble du scénario
                                                                             covoiturage

                                                                         </p>

                                                                         <p class="list-group-item">
                                                                             <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                                  width="20px" height="20px"/>
                                                                             <i style="padding-right: 10px"></i>
                                                                             <strong>{{ (distanceTotale /9 * 1.31)|round }} </strong>
                                                                             € pour réaliser les trajets de l'ensemble du scénario
                                                                             en minibus

                                                                         </p>
                                                                         <p class="list-group-item">
                                                                             <img src="{{ asset('bundles/ffbb/images/icons/car-icon.png') }}"
                                                                                  width="20px" height="20px"/>
                                                                             <i style="padding-right: 10px"></i> <strong>{{ (distanceTotale * 0.157)|round }} </strong>
                                                                             KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotal }}
                                                                             joueurs en voiture individuelle
                                                                             pour le scénario

                                                                         </p>
                                                                         <p class="list-group-item">
                                                                             <img src="{{ asset('bundles/ffbb/images/icons/covoiturage-icon.png') }}"
                                                                                  width="20px" height="20px"/>
                                                                             <i style="padding-right: 10px"></i> <strong>{{ (distanceTotale/4 * 0.157)|round }} </strong>
                                                                             KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotal }}
                                                                             joueurs en co-voiturage pour le scénario

                                                                         </p>

                                                                         <p class="list-group-item">
                                                                             <img src="{{ asset('bundles/ffbb/images/icons/bus-icon.png') }}"
                                                                                  width="20px" height="15px"/>
                                                                             <i style="padding-right: 10px"></i>
                                                                             <strong>{{ (distanceTotale/9 * 0.185)|round }} </strong>
                                                                             KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotal }}
                                                                             joueurs en minibus pour le scénario

                                                                         </p>

                                                                     </div>


                                                                 </div>

                                                                 <div class="tab-pane fade" id="Details">
                                                                     <div class="table-responsive" style="padding-top: 10px">

                                                                         <table id="example" class="display" cellspacing="0"
                                                                                width="100%">
                                                                             <thead>
                                                                             <tr>
                                                                                 <th style="font-weight: bold !important;">
                                                                                     Participants
                                                                                 </th>
                                                                                 <th style="text-align:right">Kilomètres à
                                                                                     parcourir
                                                                                 </th>
                                                                                 <th style="text-align:right">Temps de parcours
                                                                                     (H:M)
                                                                                 </th>
                                                                                 <th style="text-align:right">Coût du parcours en
                                                                                     voiture(€)
                                                                                 </th>
                                                                                 <th style="text-align:right">Coût du parcours en
                                                                                     covoiturage(€)
                                                                                 </th>
                                                                                 <th style="text-align:right">Coût du parcours en
                                                                                     minibus(€)
                                                                                 </th>
                                                                                 <th style="text-align:right">Emissions GES voiture
                                                                                     individuelle (en KG eq CO2)
                                                                                 </th>
                                                                                 <th style="text-align:right">Emissions GES
                                                                                     covoiturage (en KG eq CO2)
                                                                                 </th>

                                                                                 <th style="text-align:right">Emissions GES minibus
                                                                                     (en KG eq CO2)
                                                                                 </th>
                                                                             </tr>
                                                                             </thead>
                                                                             <tbody>

                                                                             {% for key, estimationDetailOptContrainte in estimationDetailsOptContrainte %}
                                                                                 {% set distanceOptContrainte = estimationDetailsOptContrainte[ loop.index ].distanceTotale // 1000 %}
                                                                                 {% set distanceTotaleOptContrainte = estimationDetailsOptContrainte[ loop.index ].distanceTotaleTousParticipants // 1000 %}
                                                                                 {% set dureeTotaleOptContrainte = estimationDetailsOptContrainte[ loop.index ].dureeTotale  %}
                                                                                 {% set nbrParticipantsOptContrainte = estimationDetailsOptContrainte[ loop.index ].nbrParticipantsTotal  %}
                                                                                 <tr>
                                                                                     <td><strong> Poule {{ key }} </strong></td>
                                                                                     <td style="text-align:right"> {{distanceOptContrainte }}</td>
                                                                                     <td style="text-align:right"> {{ dureeTotaleOptContrainte|date('H:i') }}</td>
                                                                                     <td style="text-align:right"> {{ (distanceTotaleOptContrainte  * 0.80)|round }}</td>
                                                                                     <td style="text-align:right"> {{ (distanceTotaleOptContrainte /4 * 0.80)|round }}</td>
                                                                                     <td style="text-align:right"> {{ (distanceTotaleOptContrainte /9 * 1.31)|round }}</td>
                                                                                     <td style="text-align:right"> {{ (distanceTotaleOptContrainte * 0.157)|round }}</td>
                                                                                     <td style="text-align:right"> {{ ((distanceTotaleOptContrainte /4)*0.157)|round  }} </td>
                                                                                     <td style="text-align:right"> {{ ((distanceTotaleOptContrainte/9)*0.185)|round }} </td>
                                                                                 </tr>

                                                                             {% endfor %}


                                                                             </tbody>
                                                                         </table>

                                                                     </div>
                                                                     <!-- /.table-responsive -->
                                                                 </div>

                                                                 <div class="tab-pane fade" id="listeRencontresScOpt">
                                                                     <div class="table-responsive" style="padding-top: 10px; max-height: 400px; overflow-y: scroll;">

                                                                         <table id="exampleTerrain" class="display"
                                                                                cellspacing="0"
                                                                                width="100%">
                                                                             <thead>
                                                                             <tr>
                                                                                 <th style="font-weight: bold !important;">
                                                                                     Poules
                                                                                 </th>
                                                                                 <th style="text-align:right">Rencontres</th>

                                                                                 <th>Equipe 1</th>

                                                                                 <th>Equipe 2</th>

                                                                             </tr>
                                                                             </thead>
                                                                             <tbody>

                                                                             {% for key, rencontreDetailOptContrainte in rencontreDetailsOptContrainte %}
                                                                                 {% set distanceOptContrainte = rencontreDetailsOptContrainte[ loop.index ] %}

                                                                                 <tr>
                                                                                     <td><strong> Poule {{ key }} </strong></td>
                                                                                     <td>
                                                                                         <ul>
                                                                                             {% for keyDetail, detailsRencontreOpContrainte in distanceOptContrainte %}
                                                                                                 <li>
                                                                                                     {{ keyDetail }}
                                                                                                 </li>

                                                                                             {% endfor %}
                                                                                         </ul>
                                                                                     </td>
                                                                                     <td>
                                                                                         <ul>
                                                                                             {% for keyDetail, detailsRencontreOpContrainte in distanceOptContrainte %}
                                                                                                 <li>
                                                                                                     {{ distanceOptContrainte[ loop.index ].equipeDepartVille }}
                                                                                                 </li>

                                                                                             {% endfor %}
                                                                                         </ul>
                                                                                     </td>

                                                                                     <td>
                                                                                         <ul>
                                                                                             {% for keyDetail, detailsRencontreOpContrainte in distanceOptContrainte %}
                                                                                                 <li>
                                                                                                     {{ distanceOptContrainte[ loop.index ].equipeDestinationVille }}
                                                                                                 </li>

                                                                                             {% endfor %}
                                                                                         </ul>
                                                                                     </td>

                                                                                 </tr>

                                                                             {% endfor %}


                                                                             </tbody>
                                                                         </table>

                                                                     </div>
                                                                     <!-- /.table-responsive -->
                                                                 </div>

                                                                 <a href="{{ path('ffbb_details_calcul') }}" class="pull-left">Détails du calcul</a>
                                                                 <button type="button" class="btn btn-primary  pull-right">Exporter </button>

                                                             </div>

                                                         </div>
                                                     </div>
                                                 </div>


                                             </div>
                                         </div>
                                         <!-- .panel-body -->
                                         <!-- /.panel -->
                                     </div>
                                     <!-- /.col-lg-6 -->

                                     <!-- Scénario équitable avec contrainte -->

                                     <div class="col-lg-6">

                                         <!-- declaration de variables -->
                                         <!-- distanceMin -->
                                         {% set distanceMinEqContrainte = scenarioEquitableAvecContrainte.estimationGenerale.distanceTotale %}
                                         {% set distanceMinEqContrainte = (distanceMinEqContrainte / 1000)|round %}
                                         <!-- distanceTotale -->
                                         {% set distanceTotaleEqContrainte = scenarioEquitableAvecContrainte.estimationGenerale.distanceTotaleTousParticipants %}
                                         {% set distanceTotaleEqContrainte = (distanceTotaleEqContrainte / 1000)|round %}
                                         <!-- nbrParticipantsTotal -->
                                         {% set nbrParticipantsTotalEqContrainte = scenarioEquitableAvecContrainte.estimationGenerale.nbrParticipantsTotal %}
                                         <!-- estimationDetails -->
                                         {% set estimationDetailsEqContrainte = scenarioEquitableAvecContrainte.estimationDetails %}
                                         <!-- rencontreDetails -->
                                         {% set rencontreDetailsEqContrainte = scenarioEquitableAvecContrainte.rencontreDetails %}
                                         <!-- coordPoules -->
                                         {% set coordPoulesEqAvecContrainte = scenarioEquitableAvecContrainte.poulesCoords %}

                                         <div class="panel-body">
                                             <div class="panel-group" id="scEquitableAvecContrainte">
                                                 <div class="panel panel-default">
                                                     <div class="panel-heading">
                                                         <h4 class="panel-title">
                                                             Scénario équitable
                                                         </h4>
                                                     </div>
                                                     <div class="panel-body"> <!-- premier scÃ©nario -->
                                                         <div id="mapEquitable"
                                                              style="width: 100%; height: 500px; background: grey"></div>
                                                         <script type="text/javascript" charset="UTF-8">

                                                             /**
                                                              *
                                                              * Changer la langue de la carte
                                                              */
                                                             function switchMapLanguage(map, platform) {
                                                                 var mapTileService = platform.getMapTileService({
                                                                             type: 'base'
                                                                         }),
                                                                         frenchMapLayer = mapTileService.createTileLayer(
                                                                                 'maptile',
                                                                                 'normal.day',
                                                                                 256,
                                                                                 'png8',
                                                                                 {lg: 'fre'}
                                                                         );
                                                                 map.setBaseLayer(frenchMapLayer);


                                                             }
                                                             /*
                                                              Fin fn changer langue
                                                              */

                                                             // Create a marker icon from an image URL:

                                                             var icons0 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon0.png') }}');
                                                             var icons1 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon1.png') }}');
                                                             var icons2 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon2.png') }}');
                                                             var icons3 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon3.png') }}');
                                                             var icons4 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon4.png') }}');
                                                             var icons5 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon5.png') }}');
                                                             var icons6 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon6.png') }}');
                                                             var icons7 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon7.png') }}');
                                                             var icons8 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon8.png') }}');
                                                             var icons9 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon9.png') }}');

                                                             //construction des points de differentes villes
                                                             function addMarkersAndSetViewBounds() {
                                                                 var incrment = 1;
                                                                 var points = [];
                                                                 var incrementIcons = 0;
                                                                 {%  for coordPouleEqAvecContrainte in coordPoulesEqAvecContrainte %}

                                                                 //tracer dynamiquement les points de villes
                                                                 {% for coordonneeVilleEqAvecContrainte in coordPouleEqAvecContrainte %}
                                                                 var x = '{{ coordonneeVilleEqAvecContrainte[0]}}';
                                                                 var y = '{{ coordonneeVilleEqAvecContrainte[1]}}';
//
                                                                 var xy = x+y;
//                                                                         var x = xy[0];
//                                                                         var y = xy[1];
                                                                 var icon = 'icons' + incrementIcons;

                                                                 var marker = 'marker' + incrment;
                                                                 window[marker] = new H.map.Marker({
                                                                     lat: parseFloat(x),
                                                                     lng: parseFloat(y)
                                                                 }, {icon: window[icon]}  );


                                                                 points.push(window[marker]);

                                                                 var incrment = incrment + 1;

                                                                 {% endfor %}
                                                                 incrementIcons++;
                                                                 {% endfor %}
                                                                 group = new H.map.Group();
                                                                 // add markers to the group
                                                                 group.addObjects(points);
                                                                 map.addObject(group);
                                                                 // get geo bounding box for the group and set it to the map
                                                                 map.setViewBounds(group.getBounds());
                                                             }



                                                             /**
                                                              * Boilerplate map initialization code starts below:
                                                              */

                                                             //Step 1: initialize communication with the platform
                                                             var platform = new H.service.Platform({
                                                                 app_id: '{{ app_id }}',
                                                                 app_code: '{{ app_code }}',
                                                                 useCIT: true,
                                                                 useHTTPS: true
                                                             });
                                                             var defaultLayers = platform.createDefaultLayers();

                                                             //Step 2: initialize a map - this map is centered over Europe
                                                             var map = new H.Map(document.getElementById('mapEquitable'),
                                                                     defaultLayers.normal.map, {
                                                                         center: {lat: 48.8567, lng: 2.3508},
                                                                         zoom: 3
                                                                     });

                                                             var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
                                                             // Create the default UI components
                                                             //    var ui = H.ui.UI.createDefault(map, defaultLayers);
                                                             var ui = H.ui.UI.createDefault(map, defaultLayers, 'fr-FR');

                                                             // Now use the map as required...
                                                             // Add the marker to the map:
                                                             // map.addObject(markerPrincipal);
                                                             addMarkersAndSetViewBounds(map);
                                                             switchMapLanguage(map, platform);

                                                         </script>
                                                         <!-- Nav tabs -->
                                                         <ul class="nav nav-tabs">
                                                             <li class="active"><a href="#EstimationsEq" data-toggle="tab">Estimations</a>
                                                             </li>
                                                             <li><a href="#DetailsEq" data-toggle="tab">Détails</a>
                                                             </li>
                                                             <li><a href="#listeRencontresScEq" data-toggle="tab">liste des rencontres</a>
                                                             </li>

                                                         </ul>

                                                         <!-- Tab panes -->
                                                         <div class="tab-content">
                                                             <div class="tab-pane fade in active" id="EstimationsEq">

                                                                 <div class="list-group">

                                                                     <p class="list-group-item">
                                                                         <i class="fa fa-road fa-fw"
                                                                            style="padding-right: 30px"></i> <strong> {{ distanceMinEqContrainte }} </strong>
                                                                         kilomètres au total
                                                                         à parcourir pour l'ensemble du scénario
                                                                     </p>
                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleEqContrainte * 0.80 )|round }} </strong>
                                                                         € pour réaliser les trajets de l'ensemble du scénario
                                                                         en voiture

                                                                     </p>
                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleEqContrainte /4 * 0.80 )|round }} </strong>
                                                                         € pour réaliser les trajets de l'ensemble du scénario
                                                                         en covoiturage

                                                                     </p>
                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i>
                                                                         <strong>{{ (distanceTotaleEqContrainte /9 * 1.31)|round }} </strong>
                                                                         € pour réaliser les trajets de l'ensemble du scénario
                                                                         en minibus

                                                                     </p>

                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/car-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleEqContrainte * 0.157)|round }} </strong>
                                                                         KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalEqContrainte }}
                                                                         joueurs en voiture individuelle
                                                                         pour le scénario

                                                                     </p>
                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/covoiturage-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong> {{ (distanceTotaleEqContrainte/4 * 0.157)|round }} </strong>
                                                                         KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalEqContrainte }}
                                                                         joueurs en co-voiturage pour le scénario

                                                                     </p>

                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/bus-icon.png') }}"
                                                                              width="20px" height="15px"/>
                                                                         <i style="padding-right: 10px"></i>
                                                                         <strong> {{ (distanceTotaleEqContrainte/9 * 0.185)|round }}</strong>
                                                                         KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalEqContrainte }}
                                                                         joueurs en minibus pour le scénario

                                                                     </p>

                                                                 </div>


                                                             </div>
                                                             <div class="tab-pane fade" id="DetailsEq">
                                                                 <div class="table-responsive" style="padding-top: 10px">

                                                                     <table id="exampleExclusion" class="display"
                                                                            cellspacing="0"
                                                                            width="100%">
                                                                         <thead>
                                                                         <tr>
                                                                             <th style="font-weight: bold !important;">
                                                                                 Participants
                                                                             </th>
                                                                             <th style="text-align:right">Kilomètres à
                                                                                 parcourir
                                                                             </th>
                                                                             <th style="text-align:right">Temps de parcours
                                                                                 (H:M)
                                                                             </th>
                                                                             <th style="text-align:right">Coût du parcours en
                                                                                 voiture(€)
                                                                             </th>
                                                                             <th style="text-align:right">Coût du parcours en
                                                                                 covoiturage(€)
                                                                             </th>
                                                                             <th style="text-align:right">Coût du parcours en
                                                                                 minibus(€)
                                                                             </th>
                                                                             <th style="text-align:right">Emissions GES voiture
                                                                                 individuelle (en KG eq CO2)
                                                                             </th>
                                                                             <th style="text-align:right">Emissions GES
                                                                                 covoiturage (en KG eq CO2)
                                                                             </th>

                                                                             <th style="text-align:right">Emissions GES minibus
                                                                                 (en KG eq CO2)
                                                                             </th>
                                                                         </tr>
                                                                         </thead>
                                                                         <tbody>


                                                                         {% for key, estimationDetailEqContrainte in estimationDetailsEqContrainte %}
                                                                             {% set distanceEqContrainte = estimationDetailsEqContrainte[ loop.index ].distanceTotale // 1000 %}
                                                                             {% set distanceTotaleEqContrainte = estimationDetailsEqContrainte[ loop.index ].distanceTotaleTousParticipants // 1000 %}
                                                                             {% set dureeTotaleEqContrainte = estimationDetailsEqContrainte[ loop.index ].dureeTotale  %}
                                                                             {% set nbrParticipantsEqContrainte = estimationDetailsEqContrainte[ loop.index ].nbrParticipantsTotal  %}
                                                                             <tr>
                                                                                 <td><strong> Poule {{ key }} </strong></td>
                                                                                 <td style="text-align:right"> {{distanceEqContrainte }}</td>
                                                                                 <td style="text-align:right"> {{ dureeTotaleEqContrainte|date('H:i') }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleEqContrainte  * 0.80)|round }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleEqContrainte /4 * 0.80)|round }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleEqContrainte /9 * 1.31)|round }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleEqContrainte * 0.157)|round }}</td>
                                                                                 <td style="text-align:right"> {{ ((distanceTotaleEqContrainte /4)*0.157)|round  }} </td>
                                                                                 <td style="text-align:right"> {{ ((distanceTotaleEqContrainte/9)*0.185)|round }} </td>
                                                                             </tr>

                                                                         {% endfor %}

                                                                         </tbody>
                                                                     </table>

                                                                 </div>
                                                                 <!-- /.table-responsive -->
                                                             </div>

                                                             <div class="tab-pane fade" id="listeRencontresScEq">
                                                                 <div class="table-responsive" style="padding-top: 10px; max-height: 400px; overflow-y: scroll;">

                                                                     <table id="scEqAvecContrainte" class="display"
                                                                            cellspacing="0"
                                                                            width="100%">
                                                                         <thead>
                                                                         <tr>
                                                                             <th style="font-weight: bold !important;">
                                                                                 Poules
                                                                             </th>
                                                                             <th style="text-align:right">Rencontres</th>

                                                                             <th>Equipe 1</th>

                                                                             <th>Equipe 2</th>

                                                                         </tr>
                                                                         </thead>
                                                                         <tbody>

                                                                         {% for keyEqContrainte, rencontreDetailEqContrainte in rencontreDetailsEqContrainte %}
                                                                             {% set distanceEqContrainte = rencontreDetailsEqContrainte[ loop.index ] %}

                                                                             <tr>
                                                                                 <td><strong> Poule {{ keyEqContrainte }} </strong></td>
                                                                                 <td>
                                                                                     <ul>
                                                                                         {% for keyDetailEqContrainte, detailsRencontreEqContrainte in distanceEqContrainte %}
                                                                                             <li>
                                                                                                 {{ keyDetailEqContrainte }}
                                                                                             </li>

                                                                                         {% endfor %}
                                                                                     </ul>
                                                                                 </td>
                                                                                 <td>
                                                                                     <ul>
                                                                                         {% for detailsRencontreEqContrainte in distanceEqContrainte %}
                                                                                             <li>
                                                                                                 {{ distanceEqContrainte[ loop.index ].equipeDepartVille }}
                                                                                             </li>

                                                                                         {% endfor %}
                                                                                     </ul>
                                                                                 </td>

                                                                                 <td>
                                                                                     <ul>
                                                                                         {% for detailsRencontreEqContrainte in distanceEqContrainte %}
                                                                                             <li>
                                                                                                 {{ distanceEqContrainte[ loop.index ].equipeDestinationVille }}
                                                                                             </li>

                                                                                         {% endfor %}
                                                                                     </ul>
                                                                                 </td>
                                                                             </tr>
                                                                         {% endfor %}


                                                                         </tbody>
                                                                     </table>

                                                                 </div>
                                                                 <!-- /.table-responsive -->
                                                             </div>
                                                             <a href="{{ path('ffbb_details_calcul') }}" class="pull-left">Détails
                                                                 du calcul</a>

                                                             <button type="button"
                                                                     class="btn btn-primary  pull-right">Exporter
                                                             </button>


                                                         </div>



                                                     </div>
                                                 </div>


                                             </div>
                                         </div>
                                         <!-- .panel-body -->
                                         <!-- /.panel -->
                                     </div>

                                     <!-- /.col-lg-6 -->
                                 </div>  <!-- Avec contraintes -->

                                 {# Deuxieme partie de cartes #}


                                 <div class="row">
                                     <!-- Scénario optimal sans contrainte -->
                                     <div class="col-lg-6">

                                         <!-- declaration de variables -->
                                         <!-- distanceMin -->
                                         {% set distanceMinOpSansContrainte = scenarioOptimalSansContrainte.estimationGenerale.distanceTotale %}
                                         {% set distanceMinOpSansContrainte = (distanceMinOpSansContrainte / 1000)|round %}
                                         <!-- distanceTotale -->
                                         {% set distanceTotaleOpSansContrainte = scenarioOptimalSansContrainte.estimationGenerale.distanceTotaleTousParticipants %}
                                         {% set distanceTotaleOpSansContrainte = (distanceTotaleOpSansContrainte / 1000)|round %}
                                         <!-- nbrParticipantsTotal -->
                                         {% set nbrParticipantsTotalOpSansContrainte = scenarioOptimalSansContrainte.estimationGenerale.nbrParticipantsTotal %}
                                         <!-- estimationDetails -->
                                         {% set estimationDetailsOpSansContrainte = scenarioOptimalSansContrainte.estimationDetails %}
                                         <!-- rencontreDetails -->
                                         {% set rencontreDetailsOpSansContrainte = scenarioOptimalSansContrainte.rencontreDetails %}
                                         <!-- coordPoules -->
                                         {% set coordPoulesOpSansContrainte = scenarioOptimalSansContrainte.poulesCoords %}
                                         <div class="panel-body">
                                             <div class="panel-group" id="scOptimalSansContrainte">
                                                 <div class="panel panel-default">
                                                     <div class="panel-heading">
                                                         <h4 class="panel-title">
                                                             Scénario optimal sans contrainte
                                                         </h4>
                                                     </div>
                                                     <div class="panel-body"> <!-- premier scÃ©nario -->
                                                         <div id="mapOpSansContrainte"
                                                              style="width: 100%; height: 500px; background: grey"></div>
                                                         <script type="text/javascript" charset="UTF-8">

                                                             /**
                                                              *
                                                              * Changer la langue de la carte
                                                              */
                                                             function switchMapLanguage(map, platform) {
                                                                 var mapTileService = platform.getMapTileService({
                                                                             type: 'base'
                                                                         }),
                                                                         frenchMapLayer = mapTileService.createTileLayer(
                                                                                 'maptile',
                                                                                 'normal.day',
                                                                                 256,
                                                                                 'png8',
                                                                                 {lg: 'fre'}
                                                                         );
                                                                 map.setBaseLayer(frenchMapLayer);


                                                             }
                                                             /*
                                                              Fin fn changer langue
                                                              */
                                                             // Create a marker icon from an image URL:

                                                             var icons0 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon0.png') }}');
                                                             var icons1 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon1.png') }}');
                                                             var icons2 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon2.png') }}');
                                                             var icons3 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon3.png') }}');
                                                             var icons4 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon4.png') }}');
                                                             var icons5 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon5.png') }}');
                                                             var icons6 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon6.png') }}');
                                                             var icons7 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon7.png') }}');
                                                             var icons8 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon8.png') }}');
                                                             var icons9 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon9.png') }}');

                                                             //construction des points de differentes villes
                                                             function addMarkersAndSetViewBounds() {
                                                                 var incrment = 1;
                                                                 var points = [];
                                                                 var incrementIcons = 0;
                                                                 {%  for coordPouleOpSansContrainte in coordPoulesOpSansContrainte %}

                                                                 //tracer dynamiquement les points de villes
                                                                 {% for coordonneeVilleOpSansContrainte in coordPouleOpSansContrainte %}
                                                                 var x = '{{ coordonneeVilleOpSansContrainte[0]}}';
                                                                 var y = '{{ coordonneeVilleOpSansContrainte[1]}}';
//
                                                                 var xy = x+y;
//                                                                         var x = xy[0];
//                                                                         var y = xy[1];

                                                                 var icon = 'icons' + incrementIcons;
                                                                 var marker = 'marker' + incrment;
                                                                 window[marker] = new H.map.Marker({
                                                                     lat: parseFloat(x),
                                                                     lng: parseFloat(y)
                                                                 }, {icon: window[icon]} );


                                                                 points.push(window[marker]);

                                                                 var incrment = incrment + 1;

                                                                 {% endfor %}
                                                                 incrementIcons++;
                                                                 {% endfor %}
                                                                 group = new H.map.Group();
                                                                 // add markers to the group
                                                                 group.addObjects(points);
                                                                 map.addObject(group);
                                                                 // get geo bounding box for the group and set it to the map
                                                                 map.setViewBounds(group.getBounds());
                                                             }



                                                             /**
                                                              * Boilerplate map initialization code starts below:
                                                              */

                                                             //Step 1: initialize communication with the platform
                                                             var platform = new H.service.Platform({
                                                                 app_id: '{{ app_id }}',
                                                                 app_code: '{{ app_code }}',
                                                                 useCIT: true,
                                                                 useHTTPS: true
                                                             });
                                                             var defaultLayers = platform.createDefaultLayers();

                                                             //Step 2: initialize a map - this map is centered over Europe
                                                             var map = new H.Map(document.getElementById('mapOpSansContrainte'),
                                                                     defaultLayers.normal.map, {
                                                                         center: {lat: 48.8567, lng: 2.3508},
                                                                         zoom: 3
                                                                     });

                                                             var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
                                                             // Create the default UI components
                                                             //    var ui = H.ui.UI.createDefault(map, defaultLayers);
                                                             var ui = H.ui.UI.createDefault(map, defaultLayers, 'fr-FR');

                                                             // Now use the map as required...
                                                             // Add the marker to the map:
                                                             // map.addObject(markerPrincipal);
                                                             addMarkersAndSetViewBounds(map);
                                                             switchMapLanguage(map, platform);

                                                         </script>

                                                         <!-- Nav tabs -->
                                                         <ul class="nav nav-tabs">
                                                             <li class="active"><a href="#EstimationsOpSansContrainte" data-toggle="tab">Estimations</a>
                                                             </li>
                                                             <li><a href="#DetailsOpSansContrainte" data-toggle="tab">Détails</a>
                                                             </li>
                                                             <li><a href="#listeRencontresOptSansContrainte" data-toggle="tab">Liste des rencontres</a></li>

                                                         </ul>

                                                         <!-- Tab panes -->
                                                         <div class="tab-content">
                                                             <div class="tab-pane fade in active" id="EstimationsOpSansContrainte">

                                                                 <div class="list-group">

                                                                     <p class="list-group-item">
                                                                         <i class="fa fa-road fa-fw"
                                                                            style="padding-right: 30px"></i> <strong>{{ distanceMinOpSansContrainte }} </strong>
                                                                         kilomètres au total
                                                                         à parcourir pour l'ensemble du scénario
                                                                     </p>
                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong> {{ (distanceTotaleOpSansContrainte * 0.80 )|round }}</strong>
                                                                         € pour réaliser les trajets de l'ensemble du scénario
                                                                         en voiture

                                                                     </p>
                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong> {{ (distanceTotaleOpSansContrainte /4 * 0.80 )|round }}</strong>
                                                                         € pour réaliser les trajets de l'ensemble du scénario
                                                                         en covoiturage

                                                                     </p>
                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i>
                                                                         <strong>{{ (distanceTotaleOpSansContrainte /9 * 1.31)|round }} </strong>
                                                                         € pour réaliser les trajets de l'ensemble du scénario
                                                                         en minibus

                                                                     </p>

                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/car-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong> {{ (distanceTotaleOpSansContrainte * 0.157)|round }}</strong>
                                                                         KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalOpSansContrainte }}
                                                                         joueurs en voiture individuelle
                                                                         pour le scénario

                                                                     </p>
                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/covoiturage-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleOpSansContrainte/4 * 0.157)|round }} </strong>
                                                                         KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalOpSansContrainte }}
                                                                         joueurs en co-voiturage pour le scénario

                                                                     </p>

                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/bus-icon.png') }}"
                                                                              width="20px" height="15px"/>
                                                                         <i style="padding-right: 10px"></i>
                                                                         <strong>{{ (distanceTotaleOpSansContrainte/9 * 0.185)|round }} </strong>
                                                                         KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalOpSansContrainte }}
                                                                         joueurs en minibus pour le scénario

                                                                     </p>

                                                                 </div>


                                                             </div>
                                                             <div class="tab-pane fade" id="DetailsOpSansContrainte">
                                                                 <div class="table-responsive" style="padding-top: 10px">

                                                                     <table id="exampleRencontreEq" class="display"
                                                                            cellspacing="0"
                                                                            width="100%">
                                                                         <thead>
                                                                         <tr>
                                                                             <th style="font-weight: bold !important;">
                                                                                 Participants
                                                                             </th>
                                                                             <th style="text-align:right">Kilomètres à
                                                                                 parcourir
                                                                             </th>
                                                                             <th style="text-align:right">Temps de parcours
                                                                                 (H:M)
                                                                             </th>
                                                                             <th style="text-align:right">Coût du parcours en
                                                                                 voiture(€)
                                                                             </th>
                                                                             <th style="text-align:right">Coût du parcours en
                                                                                 covoiturage(€)
                                                                             </th>
                                                                             <th style="text-align:right">Coût du parcours en
                                                                                 minibus(€)
                                                                             </th>
                                                                             <th style="text-align:right">Emissions GES voiture
                                                                                 individuelle (en KG eq CO2)
                                                                             </th>
                                                                             <th style="text-align:right">Emissions GES
                                                                                 covoiturage (en KG eq CO2)
                                                                             </th>

                                                                             <th style="text-align:right">Emissions GES minibus
                                                                                 (en KG eq CO2)
                                                                             </th>
                                                                         </tr>
                                                                         </thead>
                                                                         <tbody>


                                                                         {% for key, estimationDetailOpSansContrainte in estimationDetailsOpSansContrainte %}
                                                                             {% set distanceOpSansContrainte = estimationDetailsOpSansContrainte[ loop.index ].distanceTotale // 1000 %}
                                                                             {% set distanceTotaleOpSansContrainte = estimationDetailsOpSansContrainte[ loop.index ].distanceTotaleTousParticipants // 1000 %}
                                                                             {% set dureeTotaleOpSansContrainte = estimationDetailsOpSansContrainte[ loop.index ].dureeTotale  %}
                                                                             {% set nbrParticipantsOpSansContrainte = estimationDetailsOpSansContrainte[ loop.index ].nbrParticipantsTotal  %}
                                                                             <tr>
                                                                                 <td><strong> Poule {{ key }} </strong></td>
                                                                                 <td style="text-align:right"> {{distanceOpSansContrainte }}</td>
                                                                                 <td style="text-align:right"> {{ dureeTotaleOpSansContrainte|date('H:i') }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleOpSansContrainte  * 0.80)|round }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleOpSansContrainte /4 * 0.80)|round }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleOpSansContrainte /9 * 1.31)|round }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleOpSansContrainte * 0.157)|round }}</td>
                                                                                 <td style="text-align:right"> {{ ((distanceTotaleOpSansContrainte /4)*0.157)|round  }} </td>
                                                                                 <td style="text-align:right"> {{ ((distanceTotaleOpSansContrainte/9)*0.185)|round }} </td>
                                                                             </tr>

                                                                         {% endfor %}
                                                                         </tbody>
                                                                     </table>

                                                                 </div>
                                                                 <!-- /.table-responsive -->
                                                             </div>
                                                             <div class="tab-pane fade" id="listeRencontresOptSansContrainte">
                                                                 <div class="table-responsive" style="padding-top: 10px; max-height: 400px; overflow-y: scroll;">

                                                                     <table id="scEqSansContrainte" class="display"
                                                                            cellspacing="0"
                                                                            width="100%">
                                                                         <thead>
                                                                         <tr>
                                                                             <th style="font-weight: bold !important;">
                                                                                 Poules
                                                                             </th>
                                                                             <th style="text-align:right">Rencontres</th>

                                                                             <th>Equipe 1</th>

                                                                             <th>Equipe 2</th>

                                                                         </tr>
                                                                         </thead>
                                                                         <tbody>

                                                                         {% for keyOptSansContrainte, rencontreDetailOpSansContrainte in rencontreDetailsOpSansContrainte %}
                                                                             {% set distanceOptSansContrainte = rencontreDetailsOpSansContrainte[ loop.index ] %}

                                                                             <tr>
                                                                                 <td><strong> Poule {{ keyOptSansContrainte }} </strong></td>
                                                                                 <td>
                                                                                     <ul>
                                                                                         {% for keyDetailOptSansContrainte, detailsOptSansContrainte in distanceOptSansContrainte %}
                                                                                             <li>
                                                                                                 {{ keyDetailOptSansContrainte }}
                                                                                             </li>

                                                                                         {% endfor %}
                                                                                     </ul>
                                                                                 </td>
                                                                                 <td>
                                                                                     <ul>
                                                                                         {% for keyDetailOptSansContrainte, detailsOptSansContrainte in distanceOptSansContrainte %}
                                                                                             <li>
                                                                                                 {{ distanceOptSansContrainte[ loop.index ].equipeDepartVille }}
                                                                                             </li>

                                                                                         {% endfor %}
                                                                                     </ul>
                                                                                 </td>

                                                                                 <td>
                                                                                     <ul>
                                                                                         {% for keyDetailOptSansContrainte, detailsOptSansContrainte in distanceOptSansContrainte %}
                                                                                             <li>
                                                                                                 {{ distanceOptSansContrainte[ loop.index ].equipeDestinationVille }}
                                                                                             </li>

                                                                                         {% endfor %}
                                                                                     </ul>
                                                                                 </td>

                                                                             </tr>

                                                                         {% endfor %}


                                                                         </tbody>
                                                                     </table>

                                                                 </div>
                                                                 <!-- /.table-responsive -->
                                                             </div>
                                                             <a href="{{ path('ffbb_details_calcul') }}" class="pull-left">Détails
                                                                 du calcul</a>

                                                             <button type="button"
                                                                     class="btn btn-primary  pull-right">Exporter
                                                             </button>


                                                         </div>
                                                     </div>
                                                 </div>


                                             </div>
                                         </div>
                                         <!-- .panel-body -->
                                         <!-- /.panel -->
                                     </div>
                                     <!-- /.col-lg-6 -->


                                     <!-- Scénario de référence -->

                                     {% if refExiste == 1 %}
                                     <div class="col-lg-6">

                                         <!-- declaration de variables -->
                                         <!-- distanceMin -->
                                         {% set distanceMinRef = scenarioRef.estimationGenerale.distanceTotale %}
                                         {% set distanceMinRef = (distanceMinRef / 1000)|round %}
                                         <!-- distanceTotale -->
                                         {% set distanceTotaleRef = scenarioRef.estimationGenerale.distanceTotaleTousParticipants %}
                                         {% set distanceTotaleRef = (distanceTotaleRef / 1000)|round %}
                                         <!-- nbrParticipantsTotal -->
                                         {% set nbrParticipantsTotalRef = scenarioRef.estimationGenerale.nbrParticipantsTotal %}
                                         <!-- estimationDetails -->
                                         {% set estimationDetailsRef = scenarioRef.estimationDetails %}
                                         <!-- rencontreDetails -->
                                         {% set rencontreDetailsRef = scenarioRef.rencontreDetails %}
                                         <!-- coordPoules -->
                                         {% set coordPoulesRef = scenarioRef.poulesCoords %}
                                         <div class="panel-body">
                                             <div class="panel-group" id="scOptimalSansContrainte">
                                                 <div class="panel panel-default">
                                                     <div class="panel-heading">
                                                         <h4 class="panel-title">
                                                             Scénario de référence
                                                         </h4>
                                                     </div>
                                                     <div class="panel-body"> <!-- premier scÃ©nario -->
                                                         <div id="mapRef"
                                                              style="width: 100%; height: 500px; background: grey"></div>
                                                         <script type="text/javascript" charset="UTF-8">

                                                             /**
                                                              *
                                                              * Changer la langue de la carte
                                                              */
                                                             function switchMapLanguage(map, platform) {
                                                                 var mapTileService = platform.getMapTileService({
                                                                             type: 'base'
                                                                         }),
                                                                         frenchMapLayer = mapTileService.createTileLayer(
                                                                                 'maptile',
                                                                                 'normal.day',
                                                                                 256,
                                                                                 'png8',
                                                                                 {lg: 'fre'}
                                                                         );
                                                                 map.setBaseLayer(frenchMapLayer);


                                                             }
                                                             /*
                                                              Fin fn changer langue
                                                              */

                                                             // Create a marker icon from an image URL:

                                                             var icons0 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon0.png') }}');
                                                             var icons1 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon1.png') }}');
                                                             var icons2 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon2.png') }}');
                                                             var icons3 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon3.png') }}');
                                                             var icons4 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon4.png') }}');
                                                             var icons5 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon5.png') }}');
                                                             var icons6 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon6.png') }}');
                                                             var icons7 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon7.png') }}');
                                                             var icons8 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon8.png') }}');
                                                             var icons9 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon9.png') }}');

                                                             //construction des points de differentes villes
                                                             function addMarkersAndSetViewBounds() {
                                                                 var incrment = 1;
                                                                 var points = [];
                                                                 var incrementIcons = 0;
                                                                 {%  for coordPouleRef in coordPoulesRef %}

                                                                 //tracer dynamiquement les points de villes
                                                                 {% for coordonneeVilleRef in coordPouleRef %}
                                                                 var x = '{{ coordonneeVilleRef[0]}}';
                                                                 var y = '{{ coordonneeVilleRef[1]}}';
//
                                                                 var xy = x+y;
//                                                                         var x = xy[0];
//                                                                         var y = xy[1];

                                                                 var icon = 'icons' + incrementIcons;
                                                                 var marker = 'marker' + incrment;
                                                                 window[marker] = new H.map.Marker({
                                                                     lat: parseFloat(x),
                                                                     lng: parseFloat(y)
                                                                 }, {icon: window[icon]}  );


                                                                 points.push(window[marker]);

                                                                 var incrment = incrment + 1;

                                                                 {% endfor %}
                                                                 incrementIcons++;
                                                                 {% endfor %}
                                                                 group = new H.map.Group();
                                                                 // add markers to the group
                                                                 group.addObjects(points);
                                                                 map.addObject(group);
                                                                 // get geo bounding box for the group and set it to the map
                                                                 map.setViewBounds(group.getBounds());
                                                             }



                                                             /**
                                                              * Boilerplate map initialization code starts below:
                                                              */

                                                             //Step 1: initialize communication with the platform
                                                             var platform = new H.service.Platform({
                                                                 app_id: '{{ app_id }}',
                                                                 app_code: '{{ app_code }}',
                                                                 useCIT: true,
                                                                 useHTTPS: true
                                                             });
                                                             var defaultLayers = platform.createDefaultLayers();

                                                             //Step 2: initialize a map - this map is centered over Europe
                                                             var map = new H.Map(document.getElementById('mapRef'),
                                                                     defaultLayers.normal.map, {
                                                                         center: {lat: 48.8567, lng: 2.3508},
                                                                         zoom: 3
                                                                     });

                                                             var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
                                                             // Create the default UI components
                                                             //    var ui = H.ui.UI.createDefault(map, defaultLayers);
                                                             var ui = H.ui.UI.createDefault(map, defaultLayers, 'fr-FR');

                                                             // Now use the map as required...
                                                             // Add the marker to the map:
                                                             // map.addObject(markerPrincipal);
                                                             addMarkersAndSetViewBounds(map);
                                                             switchMapLanguage(map, platform);

                                                         </script>

                                                         <!-- Nav tabs -->
                                                         <ul class="nav nav-tabs">
                                                             <li class="active"><a href="#EstimationsRef" data-toggle="tab">Estimations</a>
                                                             </li>
                                                             <li><a href="#DetailsRef" data-toggle="tab">Détails</a>
                                                             </li>

                                                         </ul>

                                                         <!-- Tab panes -->
                                                         <div class="tab-content">
                                                             <div class="tab-pane fade in active" id="EstimationsRef">

                                                                 <div class="list-group">

                                                                     <p class="list-group-item">
                                                                         <i class="fa fa-road fa-fw"
                                                                            style="padding-right: 30px"></i> <strong>{{ distanceMinRef }} </strong>
                                                                         kilomètres au total
                                                                         à parcourir pour l'ensemble du scénario
                                                                     </p>
                                                                     <p href="#" class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleRef * 0.80 )|round }}</strong>
                                                                         € pour réaliser les trajets de l'ensemble du scénario
                                                                         en voiture

                                                                     </p>
                                                                     <p href="#" class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleRef /4 * 0.80 )|round }} </strong>
                                                                         € pour réaliser les trajets de l'ensemble du scénario
                                                                         covoiturage

                                                                     </p>

                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i>
                                                                         <strong> {{ (distanceTotaleRef /9 * 1.31)|round }}</strong>
                                                                         € pour réaliser les trajets de l'ensemble du scénario
                                                                         en minibus

                                                                     </p>
                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/car-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleRef * 0.157)|round }} </strong>
                                                                         KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalRef }}
                                                                         joueurs en voiture individuelle
                                                                         pour le scénario

                                                                     </p>
                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/covoiturage-icon.png') }}"
                                                                              width="20px" height="20px"/>
                                                                         <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleRef/4 * 0.157)|round }} </strong>
                                                                         KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalRef }}
                                                                         joueurs en co-voiturage pour le scénario

                                                                     </p>

                                                                     <p class="list-group-item">
                                                                         <img src="{{ asset('bundles/ffbb/images/icons/bus-icon.png') }}"
                                                                              width="20px" height="15px"/>
                                                                         <i style="padding-right: 10px"></i>
                                                                         <strong>{{ (distanceTotaleRef/9 * 0.185)|round }} </strong>
                                                                         KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalRef }}
                                                                         joueurs en minibus pour le scénario

                                                                     </p>

                                                                 </div>


                                                             </div>
                                                             <div class="tab-pane fade" id="DetailsRef">
                                                                 <div class="table-responsive" style="padding-top: 10px">

                                                                     <table id="scReference" class="display"
                                                                            cellspacing="0"
                                                                            width="100%">
                                                                         <thead>
                                                                         <tr>
                                                                             <th style="font-weight: bold !important;">
                                                                                 Participants
                                                                             </th>
                                                                             <th style="text-align:right">Kilomètres à
                                                                                 parcourir
                                                                             </th>
                                                                             <th style="text-align:right">Temps de parcours
                                                                                 (H:M)
                                                                             </th>
                                                                             <th style="text-align:right">Coût du parcours en
                                                                                 voiture(€)
                                                                             </th>
                                                                             <th style="text-align:right">Coût du parcours en
                                                                                 covoiturage(€)
                                                                             </th>
                                                                             <th style="text-align:right">Coût du parcours en
                                                                                 minibus(€)
                                                                             </th>
                                                                             <th style="text-align:right">Emissions GES voiture
                                                                                 individuelle (en KG eq CO2)
                                                                             </th>
                                                                             <th style="text-align:right">Emissions GES
                                                                                 covoiturage (en KG eq CO2)
                                                                             </th>

                                                                             <th style="text-align:right">Emissions GES minibus
                                                                                 (en KG eq CO2)
                                                                             </th>
                                                                         </tr>
                                                                         </thead>
                                                                         <tbody>



                                                                         {% for key, estimationDetailRef in estimationDetailsRef %}
                                                                             {% set distanceRef = estimationDetailsRef[ loop.index ].distanceTotale // 1000 %}
                                                                             {% set distanceTotaleRef = estimationDetailsRef[ loop.index ].distanceTotaleTousParticipants // 1000 %}
                                                                             {% set dureeTotaleRef = estimationDetailsRef[ loop.index ].dureeTotale  %}
                                                                             {% set nbrParticipantsRef = estimationDetailsRef[ loop.index ].nbrParticipantsTotal  %}
                                                                             <tr>
                                                                                 <td><strong> Poule {{ key }} </strong></td>
                                                                                 <td style="text-align:right"> {{distanceRef }}</td>
                                                                                 <td style="text-align:right"> {{ dureeTotaleRef|date('H:i') }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleRef  * 0.80)|round }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleRef /4 * 0.80)|round }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleRef /9 * 1.31)|round }}</td>
                                                                                 <td style="text-align:right"> {{ (distanceTotaleRef * 0.157)|round }}</td>
                                                                                 <td style="text-align:right"> {{ ((distanceTotaleRef /4)*0.157)|round  }} </td>
                                                                                 <td style="text-align:right"> {{ ((distanceTotaleRef/9)*0.185)|round }} </td>
                                                                             </tr>

                                                                         {% endfor %}


                                                                         </tbody>
                                                                     </table>

                                                                 </div>
                                                                 <!-- /.table-responsive -->
                                                             </div>

                                                             <a href="{{ path('ffbb_details_calcul') }}" class="pull-left">Détails
                                                                 du calcul</a>

                                                             <button type="button"
                                                                     class="btn btn-primary  pull-right">Exporter
                                                             </button>


                                                         </div>
                                                     </div>
                                                 </div>


                                             </div>
                                         </div>
                                         <!-- .panel-body -->
                                         <!-- /.panel -->
                                     </div>
                                     <!-- /.col-lg-6 -->
                                    {% endif %}

                                 </div>



                             </div>
                             <!-- .panel-body -->

                         {% else %} <!-- Pas de contrainte -->


                         <!-- .panel-heading -->
                         <div class="panel-body">
                             <div class="row">
                                 <!-- Scénario optimal sans contraintes -->
                                 <div class="col-lg-6">

                                     <!-- declaration de variables -->
                                     <!-- distanceMin -->
                                     {% set distanceMinOpSansContrainte = scenarioOptimalSansContrainte.estimationGenerale.distanceTotale %}
                                     {% set distanceMinOpSansContrainte = (distanceMinOpSansContrainte / 1000)|round %}
                                     <!-- distanceTotale -->
                                     {% set distanceTotaleOpSansContrainte = scenarioOptimalSansContrainte.estimationGenerale.distanceTotaleTousParticipants %}
                                     {% set distanceTotaleOpSansContrainte = (distanceTotaleOpSansContrainte / 1000)|round %}
                                     <!-- nbrParticipantsTotal -->
                                     {% set nbrParticipantsTotalOpSansContrainte = scenarioOptimalSansContrainte.estimationGenerale.nbrParticipantsTotal %}
                                     <!-- estimationDetails -->
                                     {% set estimationDetailsOpSansContrainte = scenarioOptimalSansContrainte.estimationDetails %}
                                     <!-- rencontreDetails -->
                                     {% set rencontreDetailsOpSansContrainte = scenarioOptimalSansContrainte.rencontreDetails %}
                                     <!-- coordPoules -->
                                     {% set coordPoulesOpSansContrainte = scenarioOptimalSansContrainte.poulesCoords %}
                                     <div class="panel-body">
                                         <div class="panel-group" id="scOptimalSansContrainte">
                                             <div class="panel panel-default">
                                                 <div class="panel-heading">
                                                     <h4 class="panel-title">
                                                         Scénario optimal sans contrainte
                                                     </h4>
                                                 </div>
                                                 <div class="panel-body"> <!-- premier scÃ©nario -->
                                                     <div id="mapOptSansContrainte"
                                                          style="width: 100%; height: 500px; background: grey"></div>

                                                     <script type="text/javascript" charset="UTF-8">

                                                         /**
                                                          *
                                                          * Changer la langue de la carte
                                                          */
                                                         function switchMapLanguage(map, platform) {
                                                             var mapTileService = platform.getMapTileService({
                                                                         type: 'base'
                                                                     }),
                                                                     frenchMapLayer = mapTileService.createTileLayer(
                                                                             'maptile',
                                                                             'normal.day',
                                                                             256,
                                                                             'png8',
                                                                             {lg: 'fre'}
                                                                     );
                                                             map.setBaseLayer(frenchMapLayer);


                                                         }
                                                         /*
                                                          Fin fn changer langue
                                                          */

                                                         // Create a marker icon from an image URL:

                                                         var icons0 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon0.png') }}');
                                                         var icons1 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon1.png') }}');
                                                         var icons2 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon2.png') }}');
                                                         var icons3 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon3.png') }}');
                                                         var icons4 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon4.png') }}');
                                                         var icons5 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon5.png') }}');
                                                         var icons6 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon6.png') }}');
                                                         var icons7 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon7.png') }}');
                                                         var icons8 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon8.png') }}');
                                                         var icons9 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon9.png') }}');


                                                         //construction des points de differentes villes
                                                         function addMarkersAndSetViewBounds() {
                                                             var incrment = 1;
                                                             var points = [];
                                                             var incrementIcons = 0;
                                                             {%  for key,coordPouleOpSansContrainte in coordPoulesOpSansContrainte %}

                                                             //tracer dynamiquement les points de villes
                                                             {% for coordonneeVilleOpSansContrainte in coordPouleOpSansContrainte %}
                                                             var x = '{{ coordonneeVilleOpSansContrainte[0]}}';
                                                             var y = '{{ coordonneeVilleOpSansContrainte[1]}}';
//
                                                             var xy = x+y;
//                                                                         var x = xy[0];
//                                                                         var y = xy[1];

                                                            var icon = 'icons' + incrementIcons;
                                                             var marker = 'marker' + incrment;
                                                             window[marker] = new H.map.Marker({
                                                                 lat: parseFloat(x),
                                                                 lng: parseFloat(y)
                                                             }, {icon: window[icon]} );


                                                             points.push(window[marker]);

                                                             var incrment = incrment + 1;

                                                             {% endfor %}
                                                             incrementIcons++;
                                                             {% endfor %}
                                                             group = new H.map.Group();
                                                             // add markers to the group
                                                             group.addObjects(points);
                                                             map.addObject(group);
                                                             // get geo bounding box for the group and set it to the map
                                                             map.setViewBounds(group.getBounds());
                                                         }



                                                         /**
                                                          * Boilerplate map initialization code starts below:
                                                          */

                                                         //Step 1: initialize communication with the platform
                                                         var platform = new H.service.Platform({
                                                             app_id: '{{ app_id }}',
                                                             app_code: '{{ app_code }}',
                                                             useCIT: true,
                                                             useHTTPS: true
                                                         });
                                                         var defaultLayers = platform.createDefaultLayers();

                                                         //Step 2: initialize a map - this map is centered over Europe
                                                         var map = new H.Map(document.getElementById('mapOptSansContrainte'),
                                                                 defaultLayers.normal.map, {
                                                                     center: {lat: 48.8567, lng: 2.3508},
                                                                     zoom: 3
                                                                 });

                                                         var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
                                                         // Create the default UI components
                                                         //    var ui = H.ui.UI.createDefault(map, defaultLayers);
                                                         var ui = H.ui.UI.createDefault(map, defaultLayers, 'fr-FR');

                                                         // Now use the map as required...
                                                         // Add the marker to the map:
                                                         // map.addObject(markerPrincipal);
                                                         addMarkersAndSetViewBounds(map);
                                                         switchMapLanguage(map, platform);

                                                     </script>

                                                     <!-- Nav tabs -->
                                                     <ul class="nav nav-tabs">
                                                         <li class="active"><a href="#EstimationsOpSansContrainte" data-toggle="tab">Estimations</a>
                                                         </li>
                                                         <li><a href="#DetailsOpSansContrainte" data-toggle="tab">Détails</a>
                                                         </li>
                                                         <li><a href="#listeRencontresOptSansContrainte" data-toggle="tab">Liste des rencontres</a></li>

                                                     </ul>

                                                     <!-- Tab panes -->
                                                     <div class="tab-content">
                                                         <div class="tab-pane fade in active" id="EstimationsOpSansContrainte">

                                                             <div class="list-group">

                                                                 <p class="list-group-item">
                                                                     <i class="fa fa-road fa-fw"
                                                                        style="padding-right: 30px"></i> <strong>{{ distanceMinOpSansContrainte }} </strong>
                                                                     kilomètres au total
                                                                     à parcourir pour l'ensemble du scénario
                                                                 </p>
                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong> {{ (distanceTotaleOpSansContrainte * 0.80 )|round }}</strong>
                                                                     € pour réaliser les trajets de l'ensemble du scénario
                                                                     en voiture

                                                                 </p>
                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong> {{ (distanceTotaleOpSansContrainte /4 * 0.80 )|round }}</strong>
                                                                     € pour réaliser les trajets de l'ensemble du scénario
                                                                     en covoiturage

                                                                 </p>
                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i>
                                                                     <strong>{{ (distanceTotaleOpSansContrainte /9 * 1.31)|round }} </strong>
                                                                     € pour réaliser les trajets de l'ensemble du scénario
                                                                     en minibus

                                                                 </p>

                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/car-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong> {{ (distanceTotaleOpSansContrainte * 0.157)|round }}</strong>
                                                                     KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalOpSansContrainte }}
                                                                     joueurs en voiture individuelle
                                                                     pour le scénario

                                                                 </p>
                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/covoiturage-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleOpSansContrainte/4 * 0.157)|round }} </strong>
                                                                     KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalOpSansContrainte }}
                                                                     joueurs en co-voiturage pour le scénario

                                                                 </p>

                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/bus-icon.png') }}"
                                                                          width="20px" height="15px"/>
                                                                     <i style="padding-right: 10px"></i>
                                                                     <strong>{{ (distanceTotaleOpSansContrainte/9 * 0.185)|round }} </strong>
                                                                     KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalOpSansContrainte }}
                                                                     joueurs en minibus pour le scénario

                                                                 </p>

                                                             </div>


                                                         </div>
                                                         <div class="tab-pane fade" id="DetailsOpSansContrainte">
                                                             <div class="table-responsive" style="padding-top: 10px">

                                                                 <table id="exampleRencontreEq" class="display"
                                                                        cellspacing="0"
                                                                        width="100%">
                                                                     <thead>
                                                                     <tr>
                                                                         <th style="font-weight: bold !important;">
                                                                             Participants
                                                                         </th>
                                                                         <th style="text-align:right">Kilomètres à
                                                                             parcourir
                                                                         </th>
                                                                         <th style="text-align:right">Temps de parcours
                                                                             (H:M)
                                                                         </th>
                                                                         <th style="text-align:right">Coût du parcours en
                                                                             voiture(€)
                                                                         </th>
                                                                         <th style="text-align:right">Coût du parcours en
                                                                             covoiturage(€)
                                                                         </th>
                                                                         <th style="text-align:right">Coût du parcours en
                                                                             minibus(€)
                                                                         </th>
                                                                         <th style="text-align:right">Emissions GES voiture
                                                                             individuelle (en KG eq CO2)
                                                                         </th>
                                                                         <th style="text-align:right">Emissions GES
                                                                             covoiturage (en KG eq CO2)
                                                                         </th>

                                                                         <th style="text-align:right">Emissions GES minibus
                                                                             (en KG eq CO2)
                                                                         </th>
                                                                     </tr>
                                                                     </thead>
                                                                     <tbody>


                                                                     {% for key, estimationDetailOpSansContrainte in estimationDetailsOpSansContrainte %}
                                                                         {% set distanceOpSansContrainte = estimationDetailsOpSansContrainte[ loop.index ].distanceTotale // 1000 %}
                                                                         {% set distanceTotaleOpSansContrainte = estimationDetailsOpSansContrainte[ loop.index ].distanceTotaleTousParticipants // 1000 %}
                                                                         {% set dureeTotaleOpSansContrainte = estimationDetailsOpSansContrainte[ loop.index ].dureeTotale  %}
                                                                         {% set nbrParticipantsOpSansContrainte = estimationDetailsOpSansContrainte[ loop.index ].nbrParticipantsTotal  %}
                                                                         <tr>
                                                                             <td><strong> Poule {{ key }} </strong></td>
                                                                             <td style="text-align:right"> {{distanceOpSansContrainte }}</td>
                                                                             <td style="text-align:right"> {{ dureeTotaleOpSansContrainte|date('H:i') }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleOpSansContrainte  * 0.80)|round }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleOpSansContrainte /4 * 0.80)|round }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleOpSansContrainte /9 * 1.31)|round }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleOpSansContrainte * 0.157)|round }}</td>
                                                                             <td style="text-align:right"> {{ ((distanceTotaleOpSansContrainte /4)*0.157)|round  }} </td>
                                                                             <td style="text-align:right"> {{ ((distanceTotaleOpSansContrainte/9)*0.185)|round }} </td>
                                                                         </tr>

                                                                     {% endfor %}
                                                                     </tbody>
                                                                 </table>

                                                             </div>
                                                             <!-- /.table-responsive -->
                                                         </div>
                                                         <div class="tab-pane fade" id="listeRencontresOptSansContrainte">
                                                             <div class="table-responsive" style="padding-top: 10px; max-height: 400px; overflow-y: scroll;">

                                                                 <table id="scEqSansContrainte" class="display"
                                                                        cellspacing="0"
                                                                        width="100%">

                                                                         <thead>
                                                                     <tr>
                                                                         <th style="font-weight: bold !important;">
                                                                             Poules
                                                                         </th>
                                                                         <th style="text-align:right">Rencontres</th>

                                                                         <th>Equipe 1</th>

                                                                         <th>Equipe 2</th>

                                                                     </tr>
                                                                     </thead>



                                                                         <tbody >
                                                                     {% for keyOptSansContrainte, rencontreDetailOpSansContrainte in rencontreDetailsOpSansContrainte %}
                                                                         {% set distanceOptSansContrainte = rencontreDetailsOpSansContrainte[ loop.index ] %}

                                                                         <tr>
                                                                             <td><strong> Poule {{ keyOptSansContrainte }} </strong></td>
                                                                             <td >
                                                                                 <ul>
                                                                                     {% for keyDetailOptSansContrainte, detailsOptSansContrainte in distanceOptSansContrainte %}
                                                                                         <li>
                                                                                             {{ keyDetailOptSansContrainte }}
                                                                                         </li>

                                                                                     {% endfor %}
                                                                                 </ul>
                                                                             </td>
                                                                             <td>
                                                                                 <ul>
                                                                                     {% for keyDetailOptSansContrainte, detailsOptSansContrainte in distanceOptSansContrainte %}
                                                                                         <li>
                                                                                             {{ distanceOptSansContrainte[ loop.index ].equipeDepartVille }}
                                                                                         </li>

                                                                                     {% endfor %}
                                                                                 </ul>
                                                                             </td>

                                                                             <td>
                                                                                 <ul>
                                                                                     {% for keyDetailOptSansContrainte, detailsOptSansContrainte in distanceOptSansContrainte %}
                                                                                         <li>
                                                                                             {{ distanceOptSansContrainte[ loop.index ].equipeDestinationVille }}
                                                                                         </li>

                                                                                     {% endfor %}
                                                                                 </ul>
                                                                             </td>

                                                                         </tr>

                                                                     {% endfor %}
                                                                         </tbody>


                                                                 </table>
                                                             </div>
                                                             <!-- /.table-responsive -->
                                                         </div>
                                                         <a href="{{ path('ffbb_details_calcul') }}" class="pull-left">Détails
                                                             du calcul</a>

                                                         <button type="button"
                                                                 class="btn btn-primary  pull-right">Exporter
                                                         </button>


                                                     </div>
                                                 </div>
                                             </div>


                                         </div>
                                     </div>
                                     <!-- .panel-body -->
                                     <!-- /.panel -->
                                 </div>
                                 <!-- /.col-lg-6 -->

                                 <!-- Scénario équitable sans contrainte -->

                                 <div class="col-lg-6">

                                     <!-- declaration de variables -->
                                     <!-- distanceMin -->
                                     {% set distanceMinEqContrainte = scenarioEquitableSansContrainte.estimationGenerale.distanceTotale %}
                                     {% set distanceMinEqContrainte = (distanceMinEqContrainte / 1000)|round %}
                                     <!-- distanceTotale -->
                                     {% set distanceTotaleEqContrainte = scenarioEquitableSansContrainte.estimationGenerale.distanceTotaleTousParticipants %}
                                     {% set distanceTotaleEqContrainte = (distanceTotaleEqContrainte / 1000)|round %}
                                     <!-- nbrParticipantsTotal -->
                                     {% set nbrParticipantsTotalEqContrainte = scenarioEquitableSansContrainte.estimationGenerale.nbrParticipantsTotal %}
                                     <!-- estimationDetails -->
                                     {% set estimationDetailsEqContrainte = scenarioEquitableSansContrainte.estimationDetails %}
                                     <!-- rencontreDetails -->
                                     {% set rencontreDetailsEqContrainte = scenarioEquitableSansContrainte.rencontreDetails %}
                                     <!-- coordPoules -->
                                     {% set coordPoulesEquitableSansContrainte = scenarioEquitableSansContrainte.poulesCoords %}

                                     <div class="panel-body">
                                         <div class="panel-group" id="scEquitableAvecContrainte">
                                             <div class="panel panel-default">
                                                 <div class="panel-heading">
                                                     <h4 class="panel-title">
                                                         Scénario équitable
                                                     </h4>
                                                 </div>
                                                 <div class="panel-body"> <!-- premier scÃ©nario -->
                                                     <div id="mapEquitableSansContrainte"
                                                          style="width: 100%; height: 500px; background: grey"></div>
                                                     <script type="text/javascript" charset="UTF-8">

                                                         /**
                                                          *
                                                          * Changer la langue de la carte
                                                          */
                                                         function switchMapLanguage(map, platform) {
                                                             var mapTileService = platform.getMapTileService({
                                                                         type: 'base'
                                                                     }),
                                                                     frenchMapLayer = mapTileService.createTileLayer(
                                                                             'maptile',
                                                                             'normal.day',
                                                                             256,
                                                                             'png8',
                                                                             {lg: 'fre'}
                                                                     );
                                                             map.setBaseLayer(frenchMapLayer);


                                                         }
                                                         /*
                                                          Fin fn changer langue
                                                          */

                                                         // Create a marker icon from an image URL:

                                                         var icons0 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon0.png') }}');
                                                         var icons1 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon1.png') }}');
                                                         var icons2 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon2.png') }}');
                                                         var icons3 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon3.png') }}');
                                                         var icons4 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon4.png') }}');
                                                         var icons5 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon5.png') }}');
                                                         var icons6 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon6.png') }}');
                                                         var icons7 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon7.png') }}');
                                                         var icons8 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon8.png') }}');
                                                         var icons9 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon9.png') }}');


                                                         //construction des points de differentes villes
                                                         function addMarkersAndSetViewBounds() {
                                                             var incrment = 1;
                                                             var points = [];
                                                             var incrementIcons = 0;

                                                             {%  for coordPouleEquitableSansContrainte in coordPoulesEquitableSansContrainte %}

                                                             //tracer dynamiquement les points de villes
                                                             {% for coordonneeVilleEquitableSansContrainte in coordPouleEquitableSansContrainte %}
                                                             var x = '{{ coordonneeVilleEquitableSansContrainte[0]}}';
                                                             var y = '{{ coordonneeVilleEquitableSansContrainte[1]}}';
//
                                                             var xy = x+y;
//                                                                         var x = xy[0];
//                                                                         var y = xy[1];

                                                             var icon = 'icons' + incrementIcons;
                                                             var marker = 'marker' + incrment;
                                                             window[marker] = new H.map.Marker({
                                                                 lat: parseFloat(x),
                                                                 lng: parseFloat(y)
                                                             } , {icon: window[icon]} );


                                                             points.push(window[marker]);

                                                             var incrment = incrment + 1;

                                                             {% endfor %}
                                                             incrementIcons++;
                                                             {% endfor %}
                                                             group = new H.map.Group();
                                                             // add markers to the group
                                                             group.addObjects(points);
                                                             map.addObject(group);
                                                             // get geo bounding box for the group and set it to the map
                                                             map.setViewBounds(group.getBounds());
                                                         }



                                                         /**
                                                          * Boilerplate map initialization code starts below:
                                                          */

                                                         //Step 1: initialize communication with the platform
                                                         var platform = new H.service.Platform({
                                                             app_id: '{{ app_id }}',
                                                             app_code: '{{ app_code }}',
                                                             useCIT: true,
                                                             useHTTPS: true
                                                         });
                                                         var defaultLayers = platform.createDefaultLayers();

                                                         //Step 2: initialize a map - this map is centered over Europe
                                                         var map = new H.Map(document.getElementById('mapEquitableSansContrainte'),
                                                                 defaultLayers.normal.map, {
                                                                     center: {lat: 48.8567, lng: 2.3508},
                                                                     zoom: 3
                                                                 });

                                                         var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
                                                         // Create the default UI components
                                                         //    var ui = H.ui.UI.createDefault(map, defaultLayers);
                                                         var ui = H.ui.UI.createDefault(map, defaultLayers, 'fr-FR');

                                                         // Now use the map as required...
                                                         // Add the marker to the map:
                                                         // map.addObject(markerPrincipal);
                                                         addMarkersAndSetViewBounds(map);
                                                         switchMapLanguage(map, platform);

                                                     </script>
                                                     <!-- Nav tabs -->
                                                     <ul class="nav nav-tabs">
                                                         <li class="active"><a href="#EstimationsEq" data-toggle="tab">Estimations</a>
                                                         </li>
                                                         <li><a href="#DetailsEq" data-toggle="tab">Détails</a>
                                                         </li>
                                                         <li><a href="#listeRencontresScEq" data-toggle="tab">liste des rencontres</a>
                                                         </li>

                                                     </ul>

                                                     <!-- Tab panes -->
                                                     <div class="tab-content">
                                                         <div class="tab-pane fade in active" id="EstimationsEq">

                                                             <div class="list-group">

                                                                 <p class="list-group-item">
                                                                     <i class="fa fa-road fa-fw"
                                                                        style="padding-right: 30px"></i> <strong> {{ distanceMinEqContrainte }} </strong>
                                                                     kilomètres au total
                                                                     à parcourir pour l'ensemble du scénario
                                                                 </p>
                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleEqContrainte * 0.80 )|round }} </strong>
                                                                     € pour réaliser les trajets de l'ensemble du scénario
                                                                     en voiture

                                                                 </p>
                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleEqContrainte /4 * 0.80 )|round }} </strong>
                                                                     € pour réaliser les trajets de l'ensemble du scénario
                                                                     en covoiturage

                                                                 </p>
                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i>
                                                                     <strong>{{ (distanceTotaleEqContrainte /9 * 1.31)|round }} </strong>
                                                                     € pour réaliser les trajets de l'ensemble du scénario
                                                                     en minibus

                                                                 </p>

                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/car-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleEqContrainte * 0.157)|round }} </strong>
                                                                     KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalEqContrainte }}
                                                                     joueurs en voiture individuelle
                                                                     pour le scénario

                                                                 </p>
                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/covoiturage-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong> {{ (distanceTotaleEqContrainte/4 * 0.157)|round }} </strong>
                                                                     KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalEqContrainte }}
                                                                     joueurs en co-voiturage pour le scénario

                                                                 </p>

                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/bus-icon.png') }}"
                                                                          width="20px" height="15px"/>
                                                                     <i style="padding-right: 10px"></i>
                                                                     <strong> {{ (distanceTotaleEqContrainte/9 * 0.185)|round }}</strong>
                                                                     KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalEqContrainte }}
                                                                     joueurs en minibus pour le scénario

                                                                 </p>

                                                             </div>


                                                         </div>
                                                         <div class="tab-pane fade" id="DetailsEq">
                                                             <div class="table-responsive" style="padding-top: 10px">

                                                                 <table id="exampleExclusion" class="display"
                                                                        cellspacing="0"
                                                                        width="100%">
                                                                     <thead>
                                                                     <tr>
                                                                         <th style="font-weight: bold !important;">
                                                                             Participants
                                                                         </th>
                                                                         <th style="text-align:right">Kilomètres à
                                                                             parcourir
                                                                         </th>
                                                                         <th style="text-align:right">Temps de parcours
                                                                             (H:M)
                                                                         </th>
                                                                         <th style="text-align:right">Coût du parcours en
                                                                             voiture(€)
                                                                         </th>
                                                                         <th style="text-align:right">Coût du parcours en
                                                                             covoiturage(€)
                                                                         </th>
                                                                         <th style="text-align:right">Coût du parcours en
                                                                             minibus(€)
                                                                         </th>
                                                                         <th style="text-align:right">Emissions GES voiture
                                                                             individuelle (en KG eq CO2)
                                                                         </th>
                                                                         <th style="text-align:right">Emissions GES
                                                                             covoiturage (en KG eq CO2)
                                                                         </th>

                                                                         <th style="text-align:right">Emissions GES minibus
                                                                             (en KG eq CO2)
                                                                         </th>
                                                                     </tr>
                                                                     </thead>
                                                                     <tbody>


                                                                     {% for key, estimationDetailEqContrainte in estimationDetailsEqContrainte %}
                                                                         {% set distanceEqContrainte = estimationDetailsEqContrainte[ loop.index ].distanceTotale // 1000 %}
                                                                         {% set distanceTotaleEqContrainte = estimationDetailsEqContrainte[ loop.index ].distanceTotaleTousParticipants // 1000 %}
                                                                         {% set dureeTotaleEqContrainte = estimationDetailsEqContrainte[ loop.index ].dureeTotale  %}
                                                                         {% set nbrParticipantsEqContrainte = estimationDetailsEqContrainte[ loop.index ].nbrParticipantsTotal  %}
                                                                         <tr>
                                                                             <td><strong> Poule {{ key }} </strong></td>
                                                                             <td style="text-align:right"> {{distanceEqContrainte }}</td>
                                                                             <td style="text-align:right"> {{ dureeTotaleEqContrainte|date('H:i') }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleEqContrainte  * 0.80)|round }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleEqContrainte /4 * 0.80)|round }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleEqContrainte /9 * 1.31)|round }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleEqContrainte * 0.157)|round }}</td>
                                                                             <td style="text-align:right"> {{ ((distanceTotaleEqContrainte /4)*0.157)|round  }} </td>
                                                                             <td style="text-align:right"> {{ ((distanceTotaleEqContrainte/9)*0.185)|round }} </td>
                                                                         </tr>

                                                                     {% endfor %}

                                                                     </tbody>
                                                                 </table>

                                                             </div>
                                                             <!-- /.table-responsive -->
                                                         </div>

                                                         <div class="tab-pane fade" id="listeRencontresScEq">
                                                             <div class="table-responsive" style="padding-top: 10px; max-height: 400px; overflow-y: scroll;">

                                                                 <table id="scEqAvecContrainte" class="display"
                                                                        cellspacing="0"
                                                                        width="100%">
                                                                     <thead>
                                                                     <tr>
                                                                         <th style="font-weight: bold !important;">
                                                                             Poules
                                                                         </th>
                                                                         <th style="text-align:right">Rencontres</th>

                                                                         <th>Equipe 1</th>

                                                                         <th>Equipe 2</th>

                                                                     </tr>
                                                                     </thead>
                                                                     <tbody>

                                                                     {% for keyEqContrainte, rencontreDetailEqContrainte in rencontreDetailsEqContrainte %}
                                                                         {% set distanceEqContrainte = rencontreDetailsEqContrainte[ loop.index ] %}

                                                                         <tr>
                                                                             <td><strong> Poule {{ keyEqContrainte }} </strong></td>
                                                                             <td>
                                                                                 <ul>
                                                                                     {% for keyDetailEqContrainte, detailsRencontreEqContrainte in distanceEqContrainte %}
                                                                                         <li>
                                                                                             {{ keyDetailEqContrainte }}
                                                                                         </li>

                                                                                     {% endfor %}
                                                                                 </ul>
                                                                             </td>
                                                                             <td>
                                                                                 <ul>
                                                                                     {% for detailsRencontreEqContrainte in distanceEqContrainte %}
                                                                                         <li>
                                                                                             {{ distanceEqContrainte[ loop.index ].equipeDepartVille }}
                                                                                         </li>

                                                                                     {% endfor %}
                                                                                 </ul>
                                                                             </td>

                                                                             <td>
                                                                                 <ul>
                                                                                     {% for detailsRencontreEqContrainte in distanceEqContrainte %}
                                                                                         <li>
                                                                                             {{ distanceEqContrainte[ loop.index ].equipeDestinationVille }}
                                                                                         </li>

                                                                                     {% endfor %}
                                                                                 </ul>
                                                                             </td>
                                                                         </tr>
                                                                     {% endfor %}


                                                                     </tbody>
                                                                 </table>

                                                             </div>
                                                             <!-- /.table-responsive -->
                                                         </div>
                                                         <a href="{{ path('ffbb_details_calcul') }}" class="pull-left">Détails
                                                             du calcul</a>

                                                         <button type="button"
                                                                 class="btn btn-primary  pull-right">Exporter
                                                         </button>


                                                     </div>



                                                 </div>
                                             </div>


                                         </div>
                                     </div>
                                     <!-- .panel-body -->
                                     <!-- /.panel -->
                                 </div>

                                 <!-- /.col-lg-6 -->




                             </div>


                             <div class="row">
                                 <!-- Scénario de référence -->


                                 {% if refExiste == 1 %}
                                 <div class="col-lg-6">

                                     <!-- declaration de variables -->
                                     <!-- distanceMin -->
                                     {% set distanceMinRef = scenarioRef.estimationGenerale.distanceTotale %}
                                     {% set distanceMinRef = (distanceMinRef / 1000)|round %}
                                     <!-- distanceTotale -->
                                     {% set distanceTotaleRef = scenarioRef.estimationGenerale.distanceTotaleTousParticipants %}
                                     {% set distanceTotaleRef = (distanceTotaleRef / 1000)|round %}
                                     <!-- nbrParticipantsTotal -->
                                     {% set nbrParticipantsTotalRef = scenarioRef.estimationGenerale.nbrParticipantsTotal %}
                                     <!-- estimationDetails -->
                                     {% set estimationDetailsRef = scenarioRef.estimationDetails %}
                                     <!-- rencontreDetails -->
                                     {% set rencontreDetailsRef = scenarioRef.rencontreDetails %}
                                     <!-- coordPoules -->
                                     {% set coordPoulesRef = scenarioRef.poulesCoords %}
                                     <div class="panel-body">
                                         <div class="panel-group" id="scOptimalSansContrainte">
                                             <div class="panel panel-default">
                                                 <div class="panel-heading">
                                                     <h4 class="panel-title">
                                                         Scénario de référence
                                                     </h4>
                                                 </div>
                                                 <div class="panel-body"> <!-- premier scÃ©nario -->
                                                     <div id="mapScRef"
                                                          style="width: 100%; height: 500px; background: grey"></div>
                                                     <script type="text/javascript" charset="UTF-8">

                                                         /**
                                                          *
                                                          * Changer la langue de la carte
                                                          */
                                                         function switchMapLanguage(map, platform) {
                                                             var mapTileService = platform.getMapTileService({
                                                                         type: 'base'
                                                                     }),
                                                                     frenchMapLayer = mapTileService.createTileLayer(
                                                                             'maptile',
                                                                             'normal.day',
                                                                             256,
                                                                             'png8',
                                                                             {lg: 'fre'}
                                                                     );
                                                             map.setBaseLayer(frenchMapLayer);


                                                         }
                                                         /*
                                                          Fin fn changer langue
                                                          */

                                                         // Create a marker icon from an image URL:

                                                         var icons0 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon0.png') }}');
                                                         var icons1 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon1.png') }}');
                                                         var icons2 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon2.png') }}');
                                                         var icons3 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon3.png') }}');
                                                         var icons4 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon4.png') }}');
                                                         var icons5 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon5.png') }}');
                                                         var icons6 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon6.png') }}');
                                                         var icons7 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon7.png') }}');
                                                         var icons8 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon8.png') }}');
                                                         var icons9 = new H.map.Icon('{{ asset('bundles/ffbb/images/icon9.png') }}');


                                                         //construction des points de differentes villes
                                                         function addMarkersAndSetViewBounds() {
                                                             var incrment = 1;
                                                             var points = [];
                                                             var incrementIcons = 0;

                                                             {%  for coordPouleRef in coordPoulesRef %}

                                                             //tracer dynamiquement les points de villes
                                                             {% for coordonneeVilleRef in coordPouleRef %}
                                                             var x = '{{ coordonneeVilleRef[0]}}';
                                                             var y = '{{ coordonneeVilleRef[1]}}';
//
                                                             var xy = x+y;
//                                                                         var x = xy[0];
//                                                                         var y = xy[1];

                                                             var icon = 'icons' + incrementIcons;
                                                             var marker = 'marker' + incrment;
                                                             window[marker] = new H.map.Marker({
                                                                 lat: parseFloat(x),
                                                                 lng: parseFloat(y)
                                                             } , {icon: window[icon]} );


                                                             points.push(window[marker]);

                                                             var incrment = incrment + 1;

                                                             {% endfor %}
                                                             incrementIcons++;
                                                             {% endfor %}
                                                             group = new H.map.Group();
                                                             // add markers to the group
                                                             group.addObjects(points);
                                                             map.addObject(group);
                                                             // get geo bounding box for the group and set it to the map
                                                             map.setViewBounds(group.getBounds());
                                                         }



                                                         /**
                                                          * Boilerplate map initialization code starts below:
                                                          */

                                                         //Step 1: initialize communication with the platform
                                                         var platform = new H.service.Platform({
                                                             app_id: '{{ app_id }}',
                                                             app_code: '{{ app_code }}',
                                                             useCIT: true,
                                                             useHTTPS: true
                                                         });
                                                         var defaultLayers = platform.createDefaultLayers();

                                                         //Step 2: initialize a map - this map is centered over Europe
                                                         var map = new H.Map(document.getElementById('mapScRef'),
                                                                 defaultLayers.normal.map, {
                                                                     center: {lat: 48.8567, lng: 2.3508},
                                                                     zoom: 3
                                                                 });

                                                         var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
                                                         // Create the default UI components
                                                         //    var ui = H.ui.UI.createDefault(map, defaultLayers);
                                                         var ui = H.ui.UI.createDefault(map, defaultLayers, 'fr-FR');

                                                         // Now use the map as required...
                                                         // Add the marker to the map:
                                                         // map.addObject(markerPrincipal);
                                                         addMarkersAndSetViewBounds(map);
                                                         switchMapLanguage(map, platform);

                                                     </script>

                                                     <!-- Nav tabs -->
                                                     <ul class="nav nav-tabs">
                                                         <li class="active"><a href="#EstimationsRef" data-toggle="tab">Estimations</a>
                                                         </li>
                                                         <li><a href="#DetailsRef" data-toggle="tab">Détails</a>
                                                         </li>

                                                     </ul>

                                                     <!-- Tab panes -->
                                                     <div class="tab-content">
                                                         <div class="tab-pane fade in active" id="EstimationsRef">

                                                             <div class="list-group">

                                                                 <p class="list-group-item">
                                                                     <i class="fa fa-road fa-fw"
                                                                        style="padding-right: 30px"></i> <strong>{{ distanceMinRef }} </strong>
                                                                     kilomètres au total
                                                                     à parcourir pour l'ensemble du scénario
                                                                 </p>
                                                                 <p href="#" class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleRef * 0.80 )|round }}</strong>
                                                                     € pour réaliser les trajets de l'ensemble du scénario
                                                                     en voiture

                                                                 </p>
                                                                 <p href="#" class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleRef /4 * 0.80 )|round }} </strong>
                                                                     € pour réaliser les trajets de l'ensemble du scénario
                                                                     covoiturage

                                                                 </p>

                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/money-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i>
                                                                     <strong> {{ (distanceTotaleRef /9 * 1.31)|round }}</strong>
                                                                     € pour réaliser les trajets de l'ensemble du scénario
                                                                     en minibus

                                                                 </p>
                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/car-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleRef * 0.157)|round }} </strong>
                                                                     KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalRef }}
                                                                     joueurs en voiture individuelle
                                                                     pour le scénario

                                                                 </p>
                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/covoiturage-icon.png') }}"
                                                                          width="20px" height="20px"/>
                                                                     <i style="padding-right: 10px"></i> <strong>{{ (distanceTotaleRef/4 * 0.157)|round }} </strong>
                                                                     KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalRef }}
                                                                     joueurs en co-voiturage pour le scénario

                                                                 </p>

                                                                 <p class="list-group-item">
                                                                     <img src="{{ asset('bundles/ffbb/images/icons/bus-icon.png') }}"
                                                                          width="20px" height="15px"/>
                                                                     <i style="padding-right: 10px"></i>
                                                                     <strong>{{ (distanceTotaleRef/9 * 0.185)|round }} </strong>
                                                                     KG eq CO2 d'émissions totales de GES pour {{ nbrParticipantsTotalRef }}
                                                                     joueurs en minibus pour le scénario

                                                                 </p>

                                                             </div>


                                                         </div>
                                                         <div class="tab-pane fade" id="DetailsRef">
                                                             <div class="table-responsive" style="padding-top: 10px">

                                                                 <table id="scReference" class="display"
                                                                        cellspacing="0"
                                                                        width="100%">
                                                                     <thead>
                                                                     <tr>
                                                                         <th style="font-weight: bold !important;">
                                                                             Participants
                                                                         </th>
                                                                         <th style="text-align:right">Kilomètres à
                                                                             parcourir
                                                                         </th>
                                                                         <th style="text-align:right">Temps de parcours
                                                                             (H:M)
                                                                         </th>
                                                                         <th style="text-align:right">Coût du parcours en
                                                                             voiture(€)
                                                                         </th>
                                                                         <th style="text-align:right">Coût du parcours en
                                                                             covoiturage(€)
                                                                         </th>
                                                                         <th style="text-align:right">Coût du parcours en
                                                                             minibus(€)
                                                                         </th>
                                                                         <th style="text-align:right">Emissions GES voiture
                                                                             individuelle (en KG eq CO2)
                                                                         </th>
                                                                         <th style="text-align:right">Emissions GES
                                                                             covoiturage (en KG eq CO2)
                                                                         </th>

                                                                         <th style="text-align:right">Emissions GES minibus
                                                                             (en KG eq CO2)
                                                                         </th>
                                                                     </tr>
                                                                     </thead>
                                                                     <tbody>



                                                                     {% for key, estimationDetailRef in estimationDetailsRef %}
                                                                         {% set distanceRef = estimationDetailsRef[ loop.index ].distanceTotale // 1000 %}
                                                                         {% set distanceTotaleRef = estimationDetailsRef[ loop.index ].distanceTotaleTousParticipants // 1000 %}
                                                                         {% set dureeTotaleRef = estimationDetailsRef[ loop.index ].dureeTotale  %}
                                                                         {% set nbrParticipantsRef = estimationDetailsRef[ loop.index ].nbrParticipantsTotal  %}
                                                                         <tr>
                                                                             <td><strong> Poule {{ key }} </strong></td>
                                                                             <td style="text-align:right"> {{distanceRef }}</td>
                                                                             <td style="text-align:right"> {{ dureeTotaleRef|date('H:i') }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleRef  * 0.80)|round }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleRef /4 * 0.80)|round }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleRef /9 * 1.31)|round }}</td>
                                                                             <td style="text-align:right"> {{ (distanceTotaleRef * 0.157)|round }}</td>
                                                                             <td style="text-align:right"> {{ ((distanceTotaleRef /4)*0.157)|round  }} </td>
                                                                             <td style="text-align:right"> {{ ((distanceTotaleRef/9)*0.185)|round }} </td>
                                                                         </tr>

                                                                     {% endfor %}


                                                                     </tbody>
                                                                 </table>

                                                             </div>
                                                             <!-- /.table-responsive -->
                                                         </div>

                                                         <a href="{{ path('ffbb_details_calcul') }}" class="pull-left">Détails
                                                             du calcul</a>

                                                         <button type="button"
                                                                 class="btn btn-primary  pull-right">Exporter
                                                         </button>


                                                     </div>
                                                 </div>
                                             </div>


                                         </div>
                                     </div>
                                     <!-- .panel-body -->
                                     <!-- /.panel -->
                                 </div>
                                 <!-- /.col-lg-6 -->
                                 {% endif %}

                             </div>

                         </div>
                             <!-- .panel-body -->

                         {% endif %}

                     </div>
                     <!-- /.panel -->
                 </div>
                 <!-- /.col-lg-12 -->
             </div>



         </div>


         {% block javascript %}

             {{ parent() }}

             <script language="javascript">

                 function typePlateau() {

                     var plateau = document.getElementById("typeRencontre3").checked;

                     if (plateau) {


                         document.getElementById("nbrJournee").style.display = "block";
                         document.getElementById("nbrRencontre").style.display = "block";
                         document.getElementById("ajoutContrainte").style.display = "block";
                     }

                 }

                 function typeAllerRetour() {

                     var allerRetour = document.getElementById("typeRencontre1").checked;
                     if (allerRetour) {
                         document.getElementById("nbrJournee").style.display = "none";
                         document.getElementById("nbrRencontre").style.display = "none";
                         document.getElementById("ajoutContrainte").style.display = "none";
                     }

                 }

                 function typeAller() {

                     var aller = document.getElementById("typeRencontre2").checked;

                     if (aller) {
                         document.getElementById("nbrJournee").style.display = "none";
                         document.getElementById("nbrRencontre").style.display = "none";
                         document.getElementById("ajoutContrainte").style.display = "none";

                     }
                 }

                 $(document).ready(function(){
                     $("#contrainteInterdiction").click(function(){
                         $("#contrainteInterdictionBody").toggle();
                     });
                 });

                 $(document).ready(function(){
                     $("#contrainteRepartition").click(function(){
                         $("#contrainteRepartitionBody").toggle();
                     });
                 });

                 // dupliquer élément
                 $('#additional-field-model').duplicateElement({
                     "class_remove": ".remove-this-field",
                     "class_create": ".create-new-field"
                 });

                 // javascript quand on clique sur le bouton 'lancer le calcul'
                 $(document).ready(function(){


                 });

                 function ajouterInterdiction(){

                     var interdiction = document.getElementById("interdiction");
                     interdiction.style.display = "block";
                 }

                 function ajouterRepartition(){

                     var repartitionHomogene = document.getElementById("repartitionHomogene");
                     repartitionHomogene.style.display = "block";
                 }

             </script>

         {% endblock %}

     {% endblock %}

